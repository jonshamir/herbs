{"version":3,"sources":["components/HerbTree/graphUtils.js","components/HerbTree/HerbTree.js","pages/HomePage/HomePage.js","components/HerbSummary/HerbSummary.js","pages/HerbPage/HerbPage.js","components/Search/Search.js","App.js","reportWebVitals.js","index.js","utils/math.js"],"names":["simulation","rootNode","graphEl","width","height","offsetX","imageSize","mousePos","x","y","setupSimulation","nodes","links","d3","alphaDecay","force","id","d","distance","strength","radius","children","alpha","forEach","node","parent","wallRepulsionX","Math","max","abs","sign","getNodeLabel","data","name","herbInfo","commonName","drawGraph","ref","svg","current","append","attr","link","selectAll","join","slug","classed","filter","depth","call","drag","on","this","collisionRadius","text","setupTooltip","tooltipContainer","tooltip","style","handleMouseMove","setupInteractions","parentComponent","e","rank","raise","setSubtreeActive","isActive","source","nodeInfo","familyInfo","html","description","transition","duration","handleClick","enteranceTransition","growthTime","linkLength","delay","ease","end","then","random","event","active","alphaTarget","restart","fx","fy","root","dist2D","target","offsetY","HerbTree","props","d3ref","React","createRef","setGraphSize","taxonomyTreePruned","applyNodeOverrides","removeSingleChildren","JSON","parse","stringify","taxonomyTree","descendants","i","initialNodePositions","fixed","setTimeout","dist","invDist","clamp01","deltaX","deltaY","dir","normalize2D","transform","angle","radToDeg","atan2","xPos","yPos","label","length","graph","window","scrollTo","document","body","scrollHeight","addEventListener","handleResize","onNodeClick","w","h","updateGraphSize","documentElement","clientWidth","min","clientHeight","nodePositions","console","log","classNames","isMinimal","stop","className","Component","taxonomyTreeOverrides","overrideNode","en","HomePage","handleScroll","currScroll","scrollTop","distToBottom","state","introOpacity","setState","handleNodeClick","redirect","debounce","history","scrollRestoration","removeEventListener","to","push","introDisplay","motion","div","initial","opacity","animate","exit","display","HerbSummary","herb","family","altNames","src","alt","colSpan","lifeform","lifecycle","HerbPage","md","a","match","params","fetch","response","familyName","taxonomy","find","hasOwnProperty","Familia","toLowerCase","main","backgroundImage","withRouter","getMatchedName","query","allNames","split","unshift","enNames","matchIndex","concat","findIndex","prefix","reduce","containsPrefix","word","slice","matchName","getMatchIndex","getSuggestions","value","inputValue","trim","map","sort","h1","h2","getSuggestionValue","suggestion","renderSuggestion","suggestionText","matches","AutosuggestMatch","parts","AutosuggestParse","part","index","highlight","Search","onChange","newValue","onSuggestionsFetchRequested","suggestions","onSuggestionsClearRequested","onSuggestionSelected","onKeyDown","key","inputProps","placeholder","App","useHistory","location","useLocation","pathname","AnimatePresence","exitBeforeEnter","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","getElementById","defined","require","EPSILON","Number","clamp","lerp","t","inverseLerp","toFinite","n","defaultValue","isFinite","expandVector","dims","TypeError","p","scalar","out","lerpArray","newArray","initialValue","mod","b","damp","lambda","dt","exp","len2D","sqrt","module","exports","fract","floor","degToRad","PI","pingPong","linspace","opts","endpoint","offset","_","lerpFrames","values","len","whole","frame","nextFrame","Array","isArray","v","smoothstep","dampArray","mapRange","inputMin","inputMax","outputMin","outputMax","outVal","expand2D","expand3D","expand4D","v1","v2"],"mappings":"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","file":"static/js/main.e0d00766.chunk.js","sourcesContent":["import * as d3 from \"d3\";\nimport { radToDeg, normalize2D, dist2D, clamp01 } from \"../../utils/math\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\nimport familyInfo from \"../../data/familyInfo.json\";\nimport initialNodePositions from \"../../data/initialNodePositions.json\";\n\nimport lang from \"../../lang\";\n\nlet width = 400;\nlet height = 400;\nconst radius = 2;\nconst marginX = 15;\nconst marginY = 30;\nconst offsetX = -30;\nconst imageSize = 40;\nconst collisionRadius = 16;\n\nlet simulation;\nlet rootNode;\nlet graphEl;\nlet mousePos = { x: -1, y: -1 };\n\nexport const graph = (ref, data, parentComponent) => {\n  rootNode = d3.hierarchy(data);\n  const links = rootNode.links();\n  const nodes = rootNode.descendants();\n  nodes.forEach((node, i) => {\n    const { id } = node.data;\n    if (id !== 1000 && initialNodePositions[id]) {\n      const { x, y } = initialNodePositions[id];\n      node.x = x;\n      node.y = y;\n    }\n  });\n\n  rootNode.fixed = true;\n  rootNode.fx = offsetX;\n  rootNode.fy = 0.5 * height - 1 * marginY;\n\n  simulation = setupSimulation(nodes, links);\n\n  const { svg, link, node, text } = drawGraph(ref, simulation, nodes, links);\n  graphEl = svg.node();\n\n  const { tooltipContainer, tooltip } = setupTooltip(svg);\n\n  // Enterance transition\n  setTimeout(() => {\n    enteranceTransition(link, svg);\n    setupInteractions(\n      svg,\n      link,\n      node,\n      text,\n      tooltip,\n      tooltipContainer,\n      parentComponent\n    );\n  }, 1000);\n\n  simulation.on(\"tick\", (e) => {\n    node.attr(\"transform\", (d) => {\n      //d.data.id === 1\n      if (mousePos.x !== -1 && !d.fixed) {\n        const dist = dist2D(d, mousePos);\n        if (dist < 20) {\n        } else if (dist < 200) {\n          const invDist = clamp01(1 - (6 * dist) / height);\n          const deltaX = d.x - mousePos.x;\n          const deltaY = d.y - mousePos.y;\n          const dir = normalize2D(deltaX, deltaY);\n          d.x += dir.x * invDist * 1.5;\n          d.y += dir.y * invDist * 1.5;\n        }\n      }\n\n      let transform = `translate(${d.x},${d.y})`;\n      if (!d.children) {\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const angle = radToDeg(Math.atan2(deltaY, deltaX)) + 90;\n        transform += ` rotate(${angle})`;\n      }\n      return transform;\n    });\n\n    text.attr(\"transform\", (d) => {\n      let xPos = d.x;\n      let yPos = d.y;\n      if (!d.children) {\n        // Leaf nodes\n        const label = getNodeLabel(d);\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const dir = normalize2D(deltaX, deltaY);\n        xPos += dir.x * (imageSize * 0.5 + label.length * 1.5);\n        yPos += dir.y * imageSize * 0.5;\n      }\n\n      return `translate(${xPos},${yPos})`;\n    });\n\n    link\n      .attr(\"x1\", (d) => d.source.x)\n      .attr(\"y1\", (d) => d.source.y)\n      .attr(\"x2\", (d) => d.target.x)\n      .attr(\"y2\", (d) => d.target.y);\n  });\n\n  return simulation;\n};\n\nexport const setupSimulation = (nodes, links) => {\n  return d3\n    .forceSimulation(nodes)\n    .alphaDecay(0.05)\n    .force(\n      \"link\",\n      d3\n        .forceLink(links)\n        .id((d) => d.id)\n        .distance(40)\n        .strength(1)\n    )\n    .force(\"charge\", d3.forceManyBody().strength(-80))\n    .force(\n      \"collision\",\n      d3.forceCollide().radius((d) => (d.children ? 2 : collisionRadius))\n    )\n    .force(\"x\", d3.forceX(offsetX / 4))\n    .force(\"y\", d3.forceY())\n    .force(\"growth\", (alpha) => {\n      nodes.forEach((node) => {\n        // Cause nodes to be above their parents\n        if (node.parent && node.y > node.parent.y - 100) {\n          node.y -= alpha * 6;\n        }\n      });\n    })\n    .force(\"bounding\", (alpha) => {\n      nodes.forEach((node) => {\n        const wallRepulsionX =\n          alpha *\n          Math.max(1, Math.abs(node.x + offsetX) - (width / 2 - marginX));\n        node.x -= Math.sign(node.x) * wallRepulsionX;\n        // const wallRepulsionY =\n        //   alpha * Math.max(1, Math.abs(node.y) - (height / 2 - marginY));\n        // node.y -= Math.sign(node.y) * wallRepulsionY;\n      });\n    });\n};\n\nconst getNodeLabel = (d) => {\n  if (d.children) return `${d.data.name}`;\n  else return herbInfo[d.data.id].commonName[lang];\n};\n\nexport const drawGraph = (ref, simulation, nodes, links) => {\n  const svg = d3\n    .select(ref.current)\n    .append(\"svg\")\n    .attr(\"class\", \"graphContainer\")\n    .attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n\n  const link = svg\n    .append(\"g\")\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"class\", \"link\")\n    .attr(\"opacity\", 0);\n\n  const node = svg\n    .append(\"g\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .attr(\"class\", (d) => `node node-${d.data.slug}`)\n    .classed(\"internode\", (d) => d.children)\n    .classed(\"leaf\", (d) => !d.children)\n    .attr(\"id\", (d) => d.data.id);\n\n  // Allow dragging for all but root node\n  node.filter((d) => d.depth > 0).call(drag(simulation));\n\n  // Internode\n  node\n    .filter((d) => d.children)\n    .append(\"circle\")\n    .attr(\"r\", radius)\n    .attr(\"opacity\", 0);\n\n  // Internode click areas\n  node\n    .filter((d) => d.children)\n    .append(\"circle\")\n    .attr(\"r\", 18)\n    .attr(\"fill-opacity\", 0)\n    .attr(\"stroke-width\", 0);\n\n  // Leaf images\n  node\n    .filter((d) => !d.children)\n    .append(\"svg:image\")\n    .attr(\"xlink:href\", (d) => `/images/icons/${d.data.slug}.png`)\n    .attr(\"class\", (d) => `image-${d.data.slug}`)\n    .on(\"error\", function (d) {\n      d3.select(this).attr(\"xlink:href\", \"/images/herb.png\");\n    })\n    .attr(\"x\", -imageSize / 2)\n    .attr(\"y\", -imageSize / 2)\n    .attr(\"width\", imageSize)\n    .attr(\"height\", imageSize)\n    .attr(\"transform\", \"scale(0.01)\");\n\n  // Leaf circle overlays\n  node\n    .filter((d) => !d.children)\n    .append(\"circle\")\n    .attr(\"r\", collisionRadius + 4);\n\n  // Leaf text\n  const text = svg\n    .append(\"g\")\n    .attr(\"class\", \"textGroup\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .append(\"text\")\n    .text(getNodeLabel)\n    .attr(\"class\", \"nodeText\")\n    .classed(\"visible\", (d) => !d.children)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"y\", (d) => (d.children ? -5 : 0))\n    .attr(\"opacity\", 0);\n  return { svg, link, node, text };\n};\n\nexport const setupTooltip = (svg) => {\n  const tooltipContainer = svg\n    .append(\"foreignObject\")\n    .attr(\"class\", \"tooltipContainer\")\n    .attr(\"width\", 200)\n    .attr(\"height\", 400);\n\n  const tooltip = tooltipContainer\n    .append(\"xhtml:div\")\n    .append(\"div\")\n    .attr(\"class\", \"tooltip\")\n    .style(\"opacity\", 0);\n\n  // Mouse hover effect\n  svg.on(\"mousemove\", handleMouseMove);\n\n  return { tooltipContainer, tooltip };\n};\n\nexport const setupInteractions = (\n  svg,\n  link,\n  node,\n  text,\n  tooltip,\n  tooltipContainer,\n  parentComponent\n) => {\n  node\n    .on(\"mouseover\", (e, d) => {\n      const { slug, name, rank } = d.data;\n\n      if (d.children) {\n        // console.log(d3.select(`.node-${slug}`));\n        d3.select(`.node-${slug}`).raise();\n        svg.classed(\"inactive\", true);\n        // text.filter((d) => d.data.id === id).classed(\"visible\", true);\n\n        setSubtreeActive(d, true);\n\n        node.classed(\"active\", (d) => d.isActive);\n        text.classed(\"active\", (d) => d.isActive);\n        link.classed(\"active\", (d) => d.source.isActive);\n\n        const nodeInfo = familyInfo[slug];\n\n        if (nodeInfo) {\n          tooltip.html(\n            `<h4>${nodeInfo.name[lang]} /<span> ${rank[lang]}</span></h4><p>${nodeInfo.description[lang]}</p>`\n          );\n        } else {\n          tooltip.html(`<h4>${name} /<span> ${rank[lang]}</span></h4>`);\n        }\n        tooltipContainer.attr(\"transform\", `translate(${d.x - 200},${d.y})`);\n        tooltip.transition().duration(300).style(\"opacity\", 1);\n      } else {\n        // d3.select(`.image-${slug}`).attr(\"transform\", `scale(1.1)`);\n      }\n    })\n    .on(\"mouseout\", (e, d) => {\n      if (d.children) {\n        svg.classed(\"inactive\", false);\n        setSubtreeActive(d, false);\n\n        const { id } = d.data;\n        text.filter((d) => d.data.id === id).classed(\"visible\", false);\n\n        tooltip.transition().duration(200).style(\"opacity\", 0);\n      } else {\n        // d3.select(`.image-${slug}`).attr(\"transform\", `scale(1)`);\n      }\n    })\n    .on(\"click\", (e, d) => {\n      parentComponent.handleClick(e, d);\n    });\n};\n\nexport const enteranceTransition = (link, svg) => {\n  const growthTime = 400;\n  link\n    .attr(\"opacity\", 1)\n    .attr(\"stroke-dasharray\", (d) => linkLength(d) + \" \" + linkLength(d))\n    .attr(\"stroke-dashoffset\", (d) => linkLength(d))\n    .transition()\n    .delay((d) => d.source.depth * growthTime - 100)\n    .duration((d) => growthTime)\n    .ease(d3.easeLinear)\n    .attr(\"stroke-dashoffset\", 0)\n    .end()\n    .then(function (e) {\n      link.attr(\"stroke-dasharray\", \"none\");\n    });\n\n  svg\n    .selectAll(\"circle, text\")\n    .transition()\n    .delay((d) => d.depth * growthTime + 500)\n    .duration(growthTime)\n    .attr(\"opacity\", 1);\n\n  svg\n    .selectAll(\"image\")\n    // .attr(\"opacity\", 1)\n    .transition()\n    .delay((d) => d.depth * growthTime + 600 * Math.random() - 300)\n    .duration(growthTime)\n    .attr(\"transform\", \"scale(1)\");\n};\n\nconst drag = (simulation) => {\n  function dragstarted(event, d) {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n\n  function dragged(event, d) {\n    d.fx = event.x;\n    d.fy = event.y;\n  }\n\n  function dragended(event, d) {\n    if (!event.active) simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n\n  return d3\n    .drag()\n    .on(\"start\", dragstarted)\n    .on(\"drag\", dragged)\n    .on(\"end\", dragended);\n};\n\nconst setSubtreeActive = (root, isActive) => {\n  root.isActive = isActive;\n  root.children && root.children.forEach((d) => setSubtreeActive(d, isActive));\n};\n\nconst linkLength = (link) => {\n  return dist2D(link.source, link.target) + 3;\n};\n\nexport const updateGraphSize = (w, h) => {\n  width = w / 2;\n  height = h;\n  d3.select(graphEl).attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n  if (simulation) {\n    simulation.alphaTarget(0.1).restart();\n\n    rootNode.fx = offsetX;\n    rootNode.fy = 0.5 * height - 1 * marginY;\n  }\n};\n\nfunction handleMouseMove(event) {\n  const { x, offsetY } = event;\n  mousePos = {\n    x: (x - width) / 2,\n    y: (offsetY - height) / 2,\n  };\n  simulation.alphaTarget(0.2).restart();\n}\n","import React from \"react\";\nimport taxonomyTree from \"../../data/taxonomyTree.json\";\nimport taxonomyTreeOverrides from \"../../data/taxonomyTreeOverrides.json\";\nimport { graph, updateGraphSize } from \"./graphUtils\";\nimport \"./HerbTree.scss\";\n\nclass HerbTree extends React.Component {\n  constructor(props) {\n    super(props);\n    this.d3ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.setGraphSize();\n\n    const taxonomyTreePruned = applyNodeOverrides(\n      removeSingleChildren(JSON.parse(JSON.stringify(taxonomyTree)))\n    );\n    this.simulation = graph(this.d3ref, taxonomyTreePruned, this);\n\n    window.scrollTo(0, document.body.scrollHeight);\n    window.addEventListener(\"resize\", (e) => this.handleResize(e));\n  }\n\n  handleResize(e) {\n    this.setGraphSize();\n  }\n\n  handleClick(event, node) {\n    if (node.height === 0) this.props.onNodeClick(node.data);\n  }\n\n  setGraphSize() {\n    const w = document.documentElement.clientWidth;\n    const h = Math.min(document.documentElement.clientHeight, 750);\n    updateGraphSize(w, h);\n  }\n\n  logPositions() {\n    const nodePositions = {};\n    this.simulation.nodes().forEach((node, i) => {\n      nodePositions[node.data.id] = { x: node.x, y: node.y };\n    });\n    console.log(JSON.stringify(nodePositions));\n  }\n\n  render() {\n    const classNames = this.props.isMinimal ? \"HerbTree minimal\" : \"HerbTree\";\n    if (this.props.isMinimal && this.simulation) this.simulation.stop();\n\n    return (\n      <div className={classNames}>\n        {/*<button onClick={() => this.logPositions()}>Get positions</button>*/}\n        <div ref={this.d3ref}></div>\n      </div>\n    );\n  }\n}\n\nconst applyNodeOverrides = (node) => {\n  if (node.children) node.children.forEach(applyNodeOverrides);\n\n  // applyNodeOverrides\n  if (node.slug in taxonomyTreeOverrides) {\n    const overrideNode = taxonomyTreeOverrides[node.slug];\n    node.name = overrideNode.name;\n    node.rank = overrideNode.rank;\n    node.slug = overrideNode.slug;\n  }\n  return node;\n};\n\nconst removeSingleChildren = (node) => {\n  if (node.children) node.children.forEach(removeSingleChildren);\n  if (\n    node.children &&\n    node.children.length === 1 &&\n    node.rank.en !== \"Cladus\"\n  ) {\n    const { id, children, name, rank, slug } = node.children[0];\n    node.id = id;\n    node.children = children;\n    node.name = name;\n    node.rank = rank;\n    node.slug = slug;\n  }\n  return node;\n};\n\nexport default HerbTree;\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport { debounce } from \"lodash\";\nimport HerbTree from \"../../components/HerbTree/HerbTree\";\n// import WindowHeader from \"../../components/WindowHeader/WindowHeader\";\nimport \"./HomePage.scss\";\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { redirect: null, introOpacity: 1 };\n    this.handleScroll = debounce(this.handleScroll, 10);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"scroll\", this.handleScroll);\n    if (window.history.scrollRestoration) {\n      window.history.scrollRestoration = \"manual\";\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n  }\n\n  handleScroll = () => {\n    const currScroll =\n      document.body.scrollTop || document.documentElement.scrollTop;\n\n    const totalHeight =\n      document.documentElement.scrollHeight -\n      document.documentElement.clientHeight;\n\n    const distToBottom = totalHeight - currScroll;\n\n    const opacityThreshold = 100;\n\n    if (distToBottom > opacityThreshold) {\n      if (this.state.introOpacity !== 0) this.setState({ introOpacity: 0 });\n    } else {\n      this.setState({ introOpacity: 1 - distToBottom / opacityThreshold });\n    }\n  };\n\n  handleNodeClick = (node) => {\n    this.setState({ redirect: `/herb/${node.slug}` });\n  };\n\n  render() {\n    if (this.state.redirect) return <Redirect to={this.state.redirect} push />;\n    const { introOpacity } = this.state;\n    const introDisplay = introOpacity > 0 ? \"block\" : \"none\";\n\n    return (\n      <motion.div\n        className=\"HomePage\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      >\n        {/*<HerbTree onNodeClick={this.handleNodeClick} />*/}\n        <main>\n          <div\n            className=\"intro\"\n            style={{ opacity: introOpacity, display: introDisplay }}\n          >\n            <h1>על טעם וריח</h1>\n            <h2>מדריך לעשבי תיבול במטבח</h2>\n            <p>\n              צמחים שעליהם משמשים להוסיף טעם למאכלים ומשקאות. הרבה מעשבי התיבול\n              המוכרים ביותר כיום, כגון בזיליקום, פטרוזיליה ואורגנו, התפתחו\n              אבולוציונית באזור הים התיכון. באופן כללי, ניתן ללמוד הרבה על צמח\n              מהשיוך הגנטי שלו - איך כדאי לגדל אותו, איך לבשל איתו ואילו טעמים\n              הוא עשוי להכיל.\n            </p>\n            <p>\n              העץ שלפניכם מציג את השיוך הגנטי של צמחי תבלין נפוצים. שורש העץ\n              מייצג את האב הקדמון של כל הצמחים בכדור הארץ. כל ענף מכיל צמחים\n              בעלי מקור גנטי משותף, שבא לידי ביטוי גם במאפיינים שונים של הצמח.\n              עברו עם העכבר על נקודות שונות בעץ כדי לגלות עוד פרטים.\n            </p>\n          </div>\n        </main>\n      </motion.div>\n    );\n  }\n}\n\nexport default HomePage;\n","import React from \"react\";\nimport lang from \"../../lang\";\nimport \"./HerbSummary.scss\";\n\nconst HerbSummary = (props) => {\n  const { slug, herb, family } = props;\n  const altNames = herb.altNames[lang];\n\n  return (\n    <div className=\"HerbSummary\">\n      <img className=\"HerbIcon\" src={`/images/icons/${slug}.png`} alt={slug} />\n      <table className=\"InfoTable\">\n        <tbody>\n          <tr>\n            <td colSpan=\"2\" className=\"scientificName\">\n              {herb.name}\n            </td>\n          </tr>\n          <tr>\n            <th>באנגלית</th>\n            <td>{herb.commonName[\"en\"]}</td>\n          </tr>\n          {altNames ? (\n            <tr>\n              <th>שמות נוספים</th>\n              <td>{altNames}</td>\n            </tr>\n          ) : null}\n          <tr>\n            <th>משפחה</th>\n            <td>{family.name[lang]}</td>\n          </tr>\n          <tr>\n            <th>צורת חיים</th>\n            <td>\n              {herb.lifeform[lang]} {herb.lifecycle[lang]}\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default HerbSummary;\n","import React from \"react\";\nimport ReactMarkdown from \"react-markdown\";\nimport { motion } from \"framer-motion\";\nimport { withRouter } from \"react-router-dom\";\nimport lang from \"../../lang\";\n\nimport HerbSummary from \"../../components/HerbSummary/HerbSummary\";\nimport herbInfo from \"../../data/herbInfo.json\";\nimport familyInfo from \"../../data/familyInfo.json\";\n\nimport \"./HerbPage.scss\";\n\nclass HerbPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { md: \"loading...\" };\n  }\n\n  async componentDidMount() {\n    const { slug } = this.props.match.params;\n    // const slug = \"bay-leaf\";\n    const response = await fetch(`/herb-pages/${slug}.md`);\n    const text = await response.text();\n\n    this.setState({\n      md: text,\n    });\n  }\n\n  render() {\n    const { slug } = this.props.match.params;\n    // const slug = \"bay-leaf\";\n    const herb = herbInfo.filter((herb) => herb.slug === slug)[0];\n    const familyName = herb.taxonomy.find((rank) =>\n      rank.hasOwnProperty(\"Familia\")\n    ).Familia;\n    const family = familyInfo[familyName.toLowerCase()];\n\n    return (\n      <motion.main\n        className=\"HerbPage\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      >\n        <HerbSummary herb={herb} slug={slug} family={family} />\n        <div className=\"HerbContent\">\n          <div\n            src={`/images/photos/${slug}.jpg`}\n            className=\"herbPhoto\"\n            style={{ backgroundImage: `url(\"/images/photos-bg/${slug}.jpg\")` }}\n          ></div>\n          <h1>{herb.commonName[lang]}</h1>\n          <ReactMarkdown>{this.state.md}</ReactMarkdown>\n          <h2>משפחת ה{family.name[lang]}</h2>\n          <p>{family.description[lang]}</p>\n        </div>\n      </motion.main>\n    );\n  }\n}\n\nexport default withRouter(HerbPage);\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport Autosuggest from \"react-autosuggest\";\nimport lang from \"../../lang\";\n\nimport AutosuggestMatch from \"autosuggest-highlight/match\";\nimport AutosuggestParse from \"autosuggest-highlight/parse\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\n\nimport \"./Search.scss\";\n\nconst doesContainPrefix = (str, prefix) => {\n  return str\n    .split(\" \")\n    .reduce(\n      (containsPrefix, word) =>\n        containsPrefix || word.slice(0, prefix.length) === prefix,\n      false\n    );\n};\n\nconst getMatchedName = (herb, query) => {\n  let allNames = herb.altNames[lang].split(\",\");\n  allNames.unshift(herb.commonName[lang]);\n  let enNames = herb.altNames.en.toLowerCase().split(\",\");\n  enNames.unshift(herb.commonName.en.toLowerCase());\n  enNames.push(herb.name.toLowerCase());\n  allNames = allNames.concat(enNames);\n\n  const matchIndex = allNames.findIndex((name) =>\n    doesContainPrefix(name, query)\n  );\n  const matchName = matchIndex > -1 ? allNames[matchIndex] : \"\";\n  return { matchName, matchIndex };\n};\n\nconst getMatchIndex = (herb, query) => {\n  return getMatchedName(herb, query).matchIndex;\n};\n\n// How to calculate suggestions for any given input value.\nconst getSuggestions = (value) => {\n  const inputValue = value.trim().toLowerCase();\n  const inputLength = inputValue.length;\n\n  if (inputLength <= 1) return [];\n\n  // Sort results by index of match\n  const matchedHerbs = herbInfo\n    .map((herb, i) => ({\n      herb,\n      matchIndex: getMatchIndex(herb, inputValue),\n    }))\n    .filter((herb) => herb.matchIndex > -1)\n    .sort((h1, h2) => h1.matchIndex - h2.matchIndex);\n\n  return matchedHerbs.map((herb) => herb.herb);\n};\n\n// When suggestion is clicked, Autosuggest needs to populate the input\n// based on the clicked suggestion. Teach Autosuggest how to calculate the\n// input value for every given suggestion.\nconst getSuggestionValue = (suggestion) => suggestion.commonName[lang];\n\n// Use your imagination to render suggestions.\nconst renderSuggestion = (suggestion, { query }) => {\n  query = query.toLowerCase();\n  const commonName = suggestion.commonName[lang];\n  const suggestionText = getMatchedName(suggestion, query).matchName;\n\n  const matches = AutosuggestMatch(suggestionText, query);\n  const parts = AutosuggestParse(suggestionText, matches);\n\n  return (\n    <div>\n      <span className=\"name\">\n        {parts.map((part, index) => {\n          const className = part.highlight ? \"highlight\" : null;\n\n          return (\n            <span className={className} key={index}>\n              {part.text}\n            </span>\n          );\n        })}\n        {suggestionText !== commonName && ` (${commonName})`}\n      </span>\n    </div>\n  );\n};\n\nclass Search extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      redirect: null,\n      value: \"\",\n      suggestions: [],\n    };\n  }\n\n  onChange = (event, { newValue }) => {\n    this.setState({\n      value: newValue,\n    });\n  };\n\n  // Autosuggest will call this function every time you need to update suggestions.\n  onSuggestionsFetchRequested = ({ value }) => {\n    this.setState({\n      suggestions: getSuggestions(value),\n    });\n  };\n\n  // Autosuggest will call this function every time you need to clear suggestions.\n  onSuggestionsClearRequested = () => {\n    this.setState({\n      suggestions: [],\n    });\n  };\n\n  onSuggestionSelected = (e, { suggestion }) => {\n    this.setState({ redirect: `/herb/${suggestion.slug}` });\n  };\n\n  onKeyDown = (e) => {\n    if (e.key === \"Enter\") {\n      const { suggestions } = this.state;\n      if (suggestions.length > 0) {\n        this.setState({ redirect: `/herb/${suggestions[0].slug}` });\n      }\n    }\n  };\n\n  render() {\n    if (this.state.redirect) return <Redirect to={this.state.redirect} push />;\n\n    const { value, suggestions } = this.state;\n\n    // Autosuggest will pass through all these props to the input.\n    const inputProps = {\n      placeholder: \"חיפוש\",\n      value,\n      onChange: this.onChange,\n      onKeyDown: this.onKeyDown,\n    };\n\n    return (\n      <div className=\"Search\">\n        <img src=\"/images/ui/search.svg\" alt=\"Search\" className=\"searchIcon\" />\n        <Autosuggest\n          suggestions={suggestions}\n          onSuggestionsFetchRequested={this.onSuggestionsFetchRequested}\n          onSuggestionsClearRequested={this.onSuggestionsClearRequested}\n          onSuggestionSelected={this.onSuggestionSelected}\n          getSuggestionValue={getSuggestionValue}\n          renderSuggestion={renderSuggestion}\n          inputProps={inputProps}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Search;\n","import React from \"react\";\nimport { AnimatePresence } from \"framer-motion\";\nimport { Route, Switch, useLocation, useHistory } from \"react-router-dom\";\nimport HomePage from \"./pages/HomePage/HomePage\";\nimport HerbPage from \"./pages/HerbPage/HerbPage\";\nimport HerbTree from \"./components/HerbTree/HerbTree\";\nimport Search from \"./components/Search/Search\";\n\nconst App = () => {\n  const history = useHistory();\n  const location = useLocation();\n\n  const handleNodeClick = (node) => {\n    history.push(`/herb/${node.slug}`);\n  };\n\n  return (\n    <div>\n      <Search />\n      <HerbTree\n        isMinimal={location.pathname !== \"/\"}\n        onNodeClick={handleNodeClick}\n      />\n      <AnimatePresence exitBeforeEnter initial={false}>\n        <Switch location={location} key={location.pathname}>\n          <Route exact path=\"/\">\n            <HomePage />\n          </Route>\n          <Route path=\"/herb/:slug\">\n            <HerbPage />\n          </Route>\n        </Switch>\n      </AnimatePresence>\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport App from \"./App\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  // <React.StrictMode>\n  <Router>\n    <App />\n  </Router>,\n  // </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","var defined = require(\"defined\");\nvar EPSILON = Number.EPSILON;\n\nfunction clamp(value, min, max) {\n  return min < max\n    ? value < min\n      ? min\n      : value > max\n      ? max\n      : value\n    : value < max\n    ? max\n    : value > min\n    ? min\n    : value;\n}\n\nfunction clamp01(v) {\n  return clamp(v, 0, 1);\n}\n\nfunction lerp(min, max, t) {\n  return min * (1 - t) + max * t;\n}\n\nfunction inverseLerp(min, max, t) {\n  if (Math.abs(min - max) < EPSILON) return 0;\n  else return (t - min) / (max - min);\n}\n\nfunction smoothstep(min, max, t) {\n  var x = clamp(inverseLerp(min, max, t), 0, 1);\n  return x * x * (3 - 2 * x);\n}\n\nfunction toFinite(n, defaultValue) {\n  defaultValue = defined(defaultValue, 0);\n  return typeof n === \"number\" && isFinite(n) ? n : defaultValue;\n}\n\nfunction expandVector(dims) {\n  if (typeof dims !== \"number\") throw new TypeError(\"Expected dims argument\");\n  return function (p, defaultValue) {\n    defaultValue = defined(defaultValue, 0);\n    var scalar;\n    if (p == null) {\n      // No vector, create a default one\n      scalar = defaultValue;\n    } else if (typeof p === \"number\" && isFinite(p)) {\n      // Expand single channel to multiple vector\n      scalar = p;\n    }\n\n    var out = [];\n    var i;\n    if (scalar == null) {\n      for (i = 0; i < dims; i++) {\n        out[i] = toFinite(p[i], defaultValue);\n      }\n    } else {\n      for (i = 0; i < dims; i++) {\n        out[i] = scalar;\n      }\n    }\n    return out;\n  };\n}\n\nfunction lerpArray(min, max, t, out) {\n  out = out || [];\n  if (min.length !== max.length) {\n    throw new TypeError(\n      \"min and max array are expected to have the same length\"\n    );\n  }\n  for (var i = 0; i < min.length; i++) {\n    out[i] = lerp(min[i], max[i], t);\n  }\n  return out;\n}\n\nfunction newArray(n, initialValue) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  var out = [];\n  for (var i = 0; i < n; i++) out.push(initialValue);\n  return out;\n}\n\nfunction linspace(n, opts) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  opts = opts || {};\n  if (typeof opts === \"boolean\") {\n    opts = { endpoint: true };\n  }\n  var offset = defined(opts.offset, 0);\n  if (opts.endpoint) {\n    return newArray(n).map(function (_, i) {\n      return n <= 1 ? 0 : (i + offset) / (n - 1);\n    });\n  } else {\n    return newArray(n).map(function (_, i) {\n      return (i + offset) / n;\n    });\n  }\n}\n\nfunction lerpFrames(values, t, out) {\n  t = clamp(t, 0, 1);\n\n  var len = values.length - 1;\n  var whole = t * len;\n  var frame = Math.floor(whole);\n  var fract = whole - frame;\n\n  var nextFrame = Math.min(frame + 1, len);\n  var a = values[frame % values.length];\n  var b = values[nextFrame % values.length];\n  if (typeof a === \"number\" && typeof b === \"number\") {\n    return lerp(a, b, fract);\n  } else if (Array.isArray(a) && Array.isArray(b)) {\n    return lerpArray(a, b, fract, out);\n  } else {\n    throw new TypeError(\n      \"Mismatch in value type of two array elements: \" +\n        frame +\n        \" and \" +\n        nextFrame\n    );\n  }\n}\n\nfunction mod(a, b) {\n  return ((a % b) + b) % b;\n}\n\nfunction degToRad(n) {\n  return (n * Math.PI) / 180;\n}\n\nfunction radToDeg(n) {\n  return (n * 180) / Math.PI;\n}\n\nfunction fract(n) {\n  return n - Math.floor(n);\n}\n\nfunction sign(n) {\n  if (n > 0) return 1;\n  else if (n < 0) return -1;\n  else return 0;\n}\n\nfunction pingPong(t, length) {\n  t = mod(t, length * 2);\n  return length - Math.abs(t - length);\n}\n\nfunction damp(a, b, lambda, dt) {\n  return lerp(a, b, 1 - Math.exp(-lambda * dt));\n}\n\nfunction dampArray(a, b, lambda, dt, out) {\n  out = out || [];\n  for (var i = 0; i < a.length; i++) {\n    out[i] = damp(a[i], b[i], lambda, dt);\n  }\n  return out;\n}\n\nfunction normalize2D(x, y) {\n  const len = len2D(x, y);\n  return { x: x / len, y: y / len };\n}\n\nfunction len2D(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction mapRange(value, inputMin, inputMax, outputMin, outputMax, clamp) {\n  // Reference:\n  // https://openframeworks.cc/documentation/math/ofMath/\n  if (Math.abs(inputMin - inputMax) < EPSILON) {\n    return outputMin;\n  } else {\n    var outVal =\n      ((value - inputMin) / (inputMax - inputMin)) * (outputMax - outputMin) +\n      outputMin;\n    if (clamp) {\n      if (outputMax < outputMin) {\n        if (outVal < outputMax) outVal = outputMax;\n        else if (outVal > outputMin) outVal = outputMin;\n      } else {\n        if (outVal > outputMax) outVal = outputMax;\n        else if (outVal < outputMin) outVal = outputMin;\n      }\n    }\n    return outVal;\n  }\n}\n\nfunction dist2D(v1, v2) {\n  return len2D(v1.x - v2.x, v1.y - v2.y);\n}\n\nmodule.exports = {\n  mod: mod,\n  fract: fract,\n  sign: sign,\n  degToRad: degToRad,\n  radToDeg: radToDeg,\n  pingPong: pingPong,\n  linspace: linspace,\n  lerp: lerp,\n  lerpArray: lerpArray,\n  inverseLerp: inverseLerp,\n  lerpFrames: lerpFrames,\n  clamp: clamp,\n  clamp01: clamp01,\n  smoothstep: smoothstep,\n  damp: damp,\n  dampArray: dampArray,\n  mapRange: mapRange,\n  expand2D: expandVector(2),\n  expand3D: expandVector(3),\n  expand4D: expandVector(4),\n  normalize2D: normalize2D,\n  len2D: len2D,\n  dist2D: dist2D,\n};\n"],"sourceRoot":""}