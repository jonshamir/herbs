{"version":3,"sources":["utils/math.js","components/IntroGraph/introGraphUtils.js","components/HerbTree/graphUtils.js","components/FadeInOut/FadeInOut.js","components/Button/Button.js","pages/HomePage/HomePage.js","components/IntroGraph/IntroGraph.js","pages/IntroPage/IntroPage.js","components/HerbSummary/HerbSummary.js","pages/HerbPage/HerbPage.js","components/HerbTree/HerbTree.js","components/Search/Search.js","App.js","reportWebVitals.js","index.js"],"names":["defined","require","EPSILON","Number","clamp","value","min","max","lerp","t","inverseLerp","Math","abs","toFinite","n","defaultValue","isFinite","expandVector","dims","TypeError","p","scalar","i","out","lerpArray","length","newArray","initialValue","push","mod","a","b","damp","lambda","dt","exp","len2D","x","y","sqrt","module","exports","fract","floor","sign","degToRad","PI","radToDeg","pingPong","linspace","opts","endpoint","offset","map","_","lerpFrames","values","len","whole","frame","nextFrame","Array","isArray","clamp01","v","smoothstep","dampArray","mapRange","inputMin","inputMax","outputMin","outputMax","outVal","expand2D","expand3D","expand4D","normalize2D","dist2D","v1","v2","svg","link","node","protoPlant","simulation","rootNode","svgEl","containerEl","text","tooltip","tooltipContainer","hoverTimer","FadeInOut","children","enterDelay","rest","motion","div","initial","opacity","animate","transition","delay","exit","Nav","className","HomePage","props","handleScroll","currScroll","document","body","scrollTop","documentElement","state","logoOpacity","setState","handleNodeClick","history","slug","window","scrollRestoration","to","React","Component","withRouter","width","height","setupSimulation","nodes","links","d3","alphaDecay","alphaMin","force","id","d","distance","strength","forceManyBodyReuse","radius","alpha","multiplier","pow","forEach","parent","drawTree","ref","current","append","attr","lower","selectAll","data","join","classed","familyInfo","growTree","growthTime","duration","linkLength","source","depth","ease","end","then","e","target","IntroGraph","d3ref","createRef","this","setGraphSize","taxonomyTreePruned","removeSingleChildren","JSON","parse","stringify","taxonomyTree","parentComponent","cx","cy","r","descendants","initialNodePositions","fixed","fx","fy","on","initTree","addEventListener","handleResize","w","h","restart","updateGraphSize","clientWidth","clientHeight","prevProps","page","updateGraph","nodePositions","console","log","rank","en","name","renderPage","setPage","onClick","IntroPage","useState","AnimatePresence","exitBeforeEnter","HerbSummary","herb","family","altNames","src","alt","colSpan","commonName","lifeform","lifecycle","HerbPage","md","imageLoaded","timerComplete","match","params","fetch","response","setTimeout","herbInfo","filter","familyName","taxonomy","find","hasOwnProperty","Familia","toLowerCase","onLoad","handleImageLoad","components","href","description","imageSize","mousePos","dist","invDist","deltaX","deltaY","dir","getNodeLabel","collisionRadius","handleMouseMove","setupTooltip","tooltipRef","style","setupInteractions","raise","setSubtreeActive","isActive","nodeInfo","html","onHover","clearTimeout","handleClick","callback","random","root","highlightDuration","positionHighlightedHerb","herbNode","getElementsByClassName","parentElement","herbRotation","transform","baseVal","angle","matrix","f","sin","cos","event","offsetY","MIN_LOGO_OPACITY","HerbTree","containerRef","isHidden","isMinimal","isInteractive","initalLoaded","positionHighlightedHerbDebounced","debounce","applyNodeOverrides","atan2","xPos","yPos","label","scrollTo","scrollHeight","onRouteChanged","removeEventListener","onNodeClick","location","prevLocation","route","pathname","routeParts","split","scaleImages","el","unhighlightAll","highlightHerb","classNames","stop","finalLogoOpacity","taxonomyTreeOverrides","overrideNode","getMatchedName","query","allNames","unshift","enNames","matchIndex","concat","findIndex","prefix","reduce","containsPrefix","word","slice","matchName","getMatchIndex","getSuggestions","inputValue","trim","sort","h1","h2","getSuggestionValue","suggestion","renderSuggestion","suggestionText","matches","AutosuggestMatch","parts","AutosuggestParse","part","index","highlight","Search","isSuggestionHighlighted","suggestions","highlightedSuggestion","some","s","onChange","newValue","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","goToResult","onSuggestionHighlighted","onKeyDown","key","inputProps","placeholder","App","useHistory","useLocation","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.808d851e.chunk.js","sourcesContent":["var defined = require(\"defined\");\nvar EPSILON = Number.EPSILON;\n\nfunction clamp(value, min, max) {\n  return min < max\n    ? value < min\n      ? min\n      : value > max\n      ? max\n      : value\n    : value < max\n    ? max\n    : value > min\n    ? min\n    : value;\n}\n\nfunction clamp01(v) {\n  return clamp(v, 0, 1);\n}\n\nfunction lerp(min, max, t) {\n  return min * (1 - t) + max * t;\n}\n\nfunction inverseLerp(min, max, t) {\n  if (Math.abs(min - max) < EPSILON) return 0;\n  else return (t - min) / (max - min);\n}\n\nfunction smoothstep(min, max, t) {\n  var x = clamp(inverseLerp(min, max, t), 0, 1);\n  return x * x * (3 - 2 * x);\n}\n\nfunction toFinite(n, defaultValue) {\n  defaultValue = defined(defaultValue, 0);\n  return typeof n === \"number\" && isFinite(n) ? n : defaultValue;\n}\n\nfunction expandVector(dims) {\n  if (typeof dims !== \"number\") throw new TypeError(\"Expected dims argument\");\n  return function (p, defaultValue) {\n    defaultValue = defined(defaultValue, 0);\n    var scalar;\n    if (p == null) {\n      // No vector, create a default one\n      scalar = defaultValue;\n    } else if (typeof p === \"number\" && isFinite(p)) {\n      // Expand single channel to multiple vector\n      scalar = p;\n    }\n\n    var out = [];\n    var i;\n    if (scalar == null) {\n      for (i = 0; i < dims; i++) {\n        out[i] = toFinite(p[i], defaultValue);\n      }\n    } else {\n      for (i = 0; i < dims; i++) {\n        out[i] = scalar;\n      }\n    }\n    return out;\n  };\n}\n\nfunction lerpArray(min, max, t, out) {\n  out = out || [];\n  if (min.length !== max.length) {\n    throw new TypeError(\n      \"min and max array are expected to have the same length\"\n    );\n  }\n  for (var i = 0; i < min.length; i++) {\n    out[i] = lerp(min[i], max[i], t);\n  }\n  return out;\n}\n\nfunction newArray(n, initialValue) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  var out = [];\n  for (var i = 0; i < n; i++) out.push(initialValue);\n  return out;\n}\n\nfunction linspace(n, opts) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  opts = opts || {};\n  if (typeof opts === \"boolean\") {\n    opts = { endpoint: true };\n  }\n  var offset = defined(opts.offset, 0);\n  if (opts.endpoint) {\n    return newArray(n).map(function (_, i) {\n      return n <= 1 ? 0 : (i + offset) / (n - 1);\n    });\n  } else {\n    return newArray(n).map(function (_, i) {\n      return (i + offset) / n;\n    });\n  }\n}\n\nfunction lerpFrames(values, t, out) {\n  t = clamp(t, 0, 1);\n\n  var len = values.length - 1;\n  var whole = t * len;\n  var frame = Math.floor(whole);\n  var fract = whole - frame;\n\n  var nextFrame = Math.min(frame + 1, len);\n  var a = values[frame % values.length];\n  var b = values[nextFrame % values.length];\n  if (typeof a === \"number\" && typeof b === \"number\") {\n    return lerp(a, b, fract);\n  } else if (Array.isArray(a) && Array.isArray(b)) {\n    return lerpArray(a, b, fract, out);\n  } else {\n    throw new TypeError(\n      \"Mismatch in value type of two array elements: \" +\n        frame +\n        \" and \" +\n        nextFrame\n    );\n  }\n}\n\nfunction mod(a, b) {\n  return ((a % b) + b) % b;\n}\n\nfunction degToRad(n) {\n  return (n * Math.PI) / 180;\n}\n\nfunction radToDeg(n) {\n  return (n * 180) / Math.PI;\n}\n\nfunction fract(n) {\n  return n - Math.floor(n);\n}\n\nfunction sign(n) {\n  if (n > 0) return 1;\n  else if (n < 0) return -1;\n  else return 0;\n}\n\nfunction pingPong(t, length) {\n  t = mod(t, length * 2);\n  return length - Math.abs(t - length);\n}\n\nfunction damp(a, b, lambda, dt) {\n  return lerp(a, b, 1 - Math.exp(-lambda * dt));\n}\n\nfunction dampArray(a, b, lambda, dt, out) {\n  out = out || [];\n  for (var i = 0; i < a.length; i++) {\n    out[i] = damp(a[i], b[i], lambda, dt);\n  }\n  return out;\n}\n\nfunction normalize2D(x, y) {\n  const len = len2D(x, y);\n  return { x: x / len, y: y / len };\n}\n\nfunction len2D(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction mapRange(value, inputMin, inputMax, outputMin, outputMax, clamp) {\n  // Reference:\n  // https://openframeworks.cc/documentation/math/ofMath/\n  if (Math.abs(inputMin - inputMax) < EPSILON) {\n    return outputMin;\n  } else {\n    var outVal =\n      ((value - inputMin) / (inputMax - inputMin)) * (outputMax - outputMin) +\n      outputMin;\n    if (clamp) {\n      if (outputMax < outputMin) {\n        if (outVal < outputMax) outVal = outputMax;\n        else if (outVal > outputMin) outVal = outputMin;\n      } else {\n        if (outVal > outputMax) outVal = outputMax;\n        else if (outVal < outputMin) outVal = outputMin;\n      }\n    }\n    return outVal;\n  }\n}\n\nfunction dist2D(v1, v2) {\n  return len2D(v1.x - v2.x, v1.y - v2.y);\n}\n\nmodule.exports = {\n  mod: mod,\n  fract: fract,\n  sign: sign,\n  degToRad: degToRad,\n  radToDeg: radToDeg,\n  pingPong: pingPong,\n  linspace: linspace,\n  lerp: lerp,\n  lerpArray: lerpArray,\n  inverseLerp: inverseLerp,\n  lerpFrames: lerpFrames,\n  clamp: clamp,\n  clamp01: clamp01,\n  smoothstep: smoothstep,\n  damp: damp,\n  dampArray: dampArray,\n  mapRange: mapRange,\n  expand2D: expandVector(2),\n  expand3D: expandVector(3),\n  expand4D: expandVector(4),\n  normalize2D: normalize2D,\n  len2D: len2D,\n  dist2D: dist2D,\n};\n","import * as d3 from \"d3\";\nimport { forceManyBodyReuse } from \"d3-force-reuse\";\nimport { normalize2D, dist2D, clamp01 } from \"../../utils/math\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\nimport familyInfo from \"../../data/familyInfo.json\";\nimport initialNodePositions from \"../../data/initialNodePositions.json\";\n\nlet width = 400;\nlet height = 400;\nconst collisionRadius = 16;\nconst marginY = 30;\n\n// Global variables\nlet svg, link, node;\nlet protoPlant;\nlet simulation;\nlet rootNode;\nlet svgEl;\nlet containerEl;\n\nconst getCirclePath = (cx, cy, r) =>\n  `M ${cx - r}, ${cy}\n   a ${r},${r} 0 1,0 ${r * 2},0\n   a ${r},${r} 0 1,0 -${r * 2},0`;\n\nexport const initTree = (ref, data, parentComponent) => {\n  rootNode = d3.hierarchy(data);\n  const links = rootNode.links();\n  const nodes = rootNode.descendants();\n  nodes.forEach((node, i) => {\n    const { id } = node.data;\n    if (id !== 1000 && initialNodePositions[id]) {\n      const { x, y } = initialNodePositions[id];\n      node.x = x;\n      node.y = y;\n    }\n  });\n\n  rootNode.fixed = true;\n  rootNode.fx = 0;\n  rootNode.fy = 0.5 * height - 1 * marginY;\n\n  setupSimulation(nodes, links);\n  drawTree(ref, simulation, nodes, links);\n\n  protoPlant = svg.append(\"g\").classed(\"protoPlant\", true).attr(\"opacity\", 0);\n  for (let i = 1; i <= 4; i++) {\n    protoPlant\n      .append(\"path\")\n      .attr(\"d\", getCirclePath(0, 0, 16))\n      .attr(\"id\", `Circle${i}`);\n  }\n\n  svgEl = svg.node();\n\n  simulation.on(\"tick\", (e) => {\n    node.attr(\"transform\", (d) => `translate(${d.x},${d.y})`);\n\n    link\n      .attr(\"x1\", (d) => d.source.x)\n      .attr(\"y1\", (d) => d.source.y)\n      .attr(\"x2\", (d) => d.target.x)\n      .attr(\"y2\", (d) => d.target.y);\n  });\n\n  return simulation;\n};\n\nexport const setupSimulation = (nodes, links) => {\n  simulation = d3\n    .forceSimulation(nodes)\n    .alphaDecay(0.05)\n    .alphaMin(0.01)\n    .force(\n      \"link\",\n      d3\n        .forceLink(links)\n        .id((d) => d.id)\n        .distance(40)\n        .strength(0.5)\n    )\n    .force(\"charge\", forceManyBodyReuse().strength(-40))\n    .force(\n      \"collision\",\n      d3.forceCollide().radius((d) => (d.children ? 2 : collisionRadius))\n    )\n    .force(\"x\", d3.forceX())\n    .force(\"y\", d3.forceY())\n    .force(\"growth\", (alpha) => {\n      const multiplier = Math.pow(alpha, 1);\n\n      nodes.forEach((node) => {\n        if (node.parent && node.y > node.parent.y - 1000) {\n          node.y -= multiplier * 6;\n        }\n      });\n    });\n};\n\nexport const showProtoPlant = () => {\n  protoPlant\n    .attr(\"transform\", \"translate(0,-50) scale(0.5)\")\n    .transition()\n    .ease(d3.easeCubicOut)\n    .duration(1000)\n    .delay(300)\n    .attr(\"opacity\", 1)\n    .attr(\"transform\", \"translate(0,-50) scale(1)\");\n};\n\nexport const moveProtoPlant = () => {\n  return protoPlant\n    .transition()\n    .ease(d3.easeCubicIn)\n    .duration(1000)\n    .delay(300)\n    .attr(\"transform\", `translate(0,${rootNode.fy}) scale(0.15)`)\n    .end();\n};\n\nexport const drawTree = (ref, simulation, nodes, links) => {\n  containerEl = ref.current;\n\n  svg = d3\n    .select(containerEl)\n    .append(\"svg\")\n    .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n    .lower();\n\n  link = svg\n    .append(\"g\")\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"class\", \"link\")\n    .attr(\"stroke\", \"#ccc\")\n    .attr(\"opacity\", 0);\n\n  node = svg\n    .append(\"g\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .attr(\"class\", (d) => `node node-${d.data.slug}`)\n    .classed(\"internode\", (d) => d.children)\n    .classed(\"family\", (d) => d.data.slug in familyInfo)\n    .classed(\"leaf\", (d) => !d.children)\n    .attr(\"id\", (d) => d.data.id);\n\n  // Internodes\n  node\n    .append(\"circle\")\n    .attr(\"r\", 2.8)\n    .attr(\"fill\", \"#ccc\")\n    .attr(\"stroke\", \"#f9f5f4\")\n    .attr(\"stroke-width\", \"1.5\")\n    .attr(\"transform\", \"scale(0.01)\");\n};\n\nexport const fadeOut = () => {\n  return svg\n    .selectAll(\"g:not(.protoPlant)\")\n    .attr(\"opacity\", 1)\n    .transition()\n    .duration(1000)\n    .attr(\"opacity\", 0)\n    .end();\n};\n\nexport const growTree = (growthTime = 550) => {\n  protoPlant\n    .transition()\n    .duration(growthTime * 3)\n    .attr(\"opacity\", 0);\n\n  link\n    .attr(\"opacity\", 1)\n    .attr(\"stroke-dasharray\", (d) => linkLength(d) + \" \" + linkLength(d))\n    .attr(\"stroke-dashoffset\", (d) => linkLength(d))\n    .transition()\n    .delay((d) => d.source.depth * growthTime - 100)\n    .duration((d) => growthTime)\n    .ease(d3.easeLinear)\n    .attr(\"stroke-dashoffset\", 0)\n    .end()\n    .then(function (e) {\n      link.attr(\"stroke-dasharray\", \"none\");\n    });\n\n  svg\n    .selectAll(\"circle\")\n    .transition()\n    .delay((d) => d.depth * growthTime - 100)\n    .duration(growthTime)\n    .attr(\"transform\", \"\")\n    .end();\n};\n\nconst linkLength = (link) => {\n  return dist2D(link.source, link.target) + 3;\n};\n\nexport const updateGraphSize = (w, h) => {\n  width = w / 2;\n  height = h / 2;\n  d3.select(svgEl).attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n  if (simulation) {\n    simulation.alpha(0.2).restart();\n\n    rootNode.fx = 0;\n    rootNode.fy = 0.5 * height - 1 * marginY;\n  }\n};\n","import * as d3 from \"d3\";\nimport { forceManyBodyReuse } from \"d3-force-reuse\";\nimport {\n  radToDeg,\n  degToRad,\n  normalize2D,\n  dist2D,\n  clamp01,\n} from \"../../utils/math\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\nimport familyInfo from \"../../data/familyInfo.json\";\nimport initialNodePositions from \"../../data/initialNodePositions.json\";\n\nimport lang from \"../../lang\";\n\nlet width = 400;\nlet height = 400;\n// const marginX = 15;\nconst marginY = 30;\nconst offsetX = 0;\nconst imageSize = 40;\nconst collisionRadius = 16;\n\n// Global variables\nlet svg, link, node, text;\nlet tooltip, tooltipContainer;\nlet simulation;\nlet rootNode;\nlet svgEl;\nlet containerEl;\nlet mousePos = { x: -1, y: -1 };\n\nexport const initTree = (ref, tooltipRef, data, parentComponent) => {\n  rootNode = d3.hierarchy(data);\n  const links = rootNode.links();\n  const nodes = rootNode.descendants();\n  nodes.forEach((node, i) => {\n    const { id } = node.data;\n    if (id !== 1000 && initialNodePositions[id]) {\n      const { x, y } = initialNodePositions[id];\n      node.x = x;\n      node.y = y;\n    }\n  });\n\n  rootNode.fixed = true;\n  rootNode.fx = offsetX;\n  rootNode.fy = 0.5 * height - 1 * marginY;\n\n  setupSimulation(nodes, links);\n  drawTree(ref, simulation, nodes, links);\n  setupTooltip(tooltipRef);\n  setupInteractions(parentComponent);\n\n  svgEl = svg.node();\n\n  simulation.on(\"tick\", (e) => {\n    node.attr(\"transform\", (d) => {\n      let transform = `translate(${d.x},${d.y})`;\n      if (!d.children) {\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const angle = radToDeg(Math.atan2(deltaY, deltaX)) + 90;\n        transform += ` rotate(${angle})`;\n      }\n      return transform;\n    });\n\n    text.attr(\"transform\", (d) => {\n      let xPos = d.x;\n      let yPos = d.y;\n      if (!d.children) {\n        // Leaf nodes\n        const label = getNodeLabel(d);\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const dir = normalize2D(deltaX, deltaY);\n        xPos += dir.x * (imageSize * 0.5 + label.length * 1.5);\n        yPos += dir.y * imageSize * 0.5;\n      }\n\n      return `translate(${xPos},${yPos})`;\n    });\n\n    link\n      .attr(\"x1\", (d) => d.source.x)\n      .attr(\"y1\", (d) => d.source.y)\n      .attr(\"x2\", (d) => d.target.x)\n      .attr(\"y2\", (d) => d.target.y);\n  });\n\n  return simulation;\n};\n\nexport const setupSimulation = (nodes, links) => {\n  simulation = d3\n    .forceSimulation(nodes)\n    .alphaDecay(0.05)\n    .alphaMin(0.01)\n    .force(\n      \"link\",\n      d3\n        .forceLink(links)\n        .id((d) => d.id)\n        .distance(40)\n        .strength(0.5)\n    )\n    .force(\"charge\", forceManyBodyReuse().strength(-80))\n    .force(\n      \"collision\",\n      d3.forceCollide().radius((d) => (d.children ? 2 : collisionRadius))\n    )\n    .force(\"x\", d3.forceX(offsetX))\n    .force(\"y\", d3.forceY())\n    .force(\"mouse\", (alpha) => {\n      nodes.forEach((d) => {\n        if (mousePos.x !== -1 && !d.fixed) {\n          const dist = dist2D(d, mousePos);\n          if (dist < 25) {\n            // Snap to cursor\n          } else if (dist < 250) {\n            const invDist = Math.pow(clamp01(1 - (6 * dist) / height), 2);\n            const deltaX = d.x - mousePos.x;\n            const deltaY = d.y - mousePos.y;\n            const dir = normalize2D(deltaX, deltaY);\n            d.x += dir.x * invDist * 12 * alpha;\n            d.y += dir.y * invDist * 12 * alpha;\n          }\n        }\n      });\n    });\n  /*\n    .force(\"growth\", (alpha) => {\n      const multiplier = Math.pow(alpha, 1);\n\n      nodes.forEach((node) => {\n        // Cause nodes to be above their parents\n        if (node.parent && node.y > node.parent.y - 1000) {\n          node.y -= multiplier * 6;\n        }\n      });\n    })\n    .force(\"bounding\", (alpha) => {\n      nodes.forEach((node) => {\n        const wallRepulsionX =\n          alpha *\n          Math.max(1, Math.abs(node.x + offsetX) - (width / 2 - marginX));\n        node.x -= Math.sign(node.x) * wallRepulsionX;\n        // const wallRepulsionY =\n        //   alpha * Math.max(1, Math.abs(node.y) - (height / 2 - marginY));\n        // node.y -= Math.sign(node.y) * wallRepulsionY;\n      });\n    });*/\n};\n\nconst getNodeLabel = (d) => {\n  if (d.children) return `${d.data.name}`;\n  else return herbInfo[d.data.id].commonName[lang];\n};\n\nexport const drawTree = (ref, simulation, nodes, links) => {\n  containerEl = ref.current;\n\n  svg = d3\n    .select(containerEl)\n    .append(\"svg\")\n    .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n    .lower();\n\n  link = svg\n    .append(\"g\")\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"class\", \"link\")\n    .attr(\"opacity\", 0);\n\n  node = svg\n    .append(\"g\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .attr(\"class\", (d) => `node node-${d.data.slug}`)\n    .classed(\"internode\", (d) => d.children)\n    .classed(\"family\", (d) => d.data.slug in familyInfo)\n    .classed(\"leaf\", (d) => !d.children)\n    .attr(\"id\", (d) => d.data.id);\n\n  // Internode\n  node\n    .filter((d) => d.children)\n    .append(\"circle\")\n    .attr(\"r\", (d) => (d.data.slug in familyInfo ? 2 : 1.5))\n    .attr(\"transform\", \"scale(0.01)\");\n\n  // Internode click areas\n  node\n    .filter((d) => d.children)\n    .append(\"circle\")\n    .attr(\"r\", 18)\n    .attr(\"fill-opacity\", 0)\n    .attr(\"stroke-width\", 0);\n\n  // Leaf images\n  node\n    .filter((d) => !d.children)\n    .append(\"svg:image\")\n    .attr(\"xlink:href\", (d) => `/images/icons/${d.data.slug}.png`)\n    .attr(\"class\", (d) => `image-${d.data.slug}`)\n    .on(\"error\", function (d) {\n      d3.select(this).attr(\"xlink:href\", \"/images/herb.png\");\n    })\n    .attr(\"x\", -imageSize / 2)\n    .attr(\"y\", -imageSize / 2)\n    .attr(\"width\", imageSize)\n    .attr(\"height\", imageSize)\n    .attr(\"transform\", \"scale(0.01)\");\n\n  // Leaf circle overlays\n  node\n    .filter((d) => !d.children)\n    .append(\"circle\")\n    .attr(\"r\", collisionRadius + 4);\n\n  // Mouse hover effect\n  svg.on(\"mousemove\", handleMouseMove);\n\n  // Leaf text\n  text = svg\n    .append(\"g\")\n    .attr(\"class\", \"textGroup\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .append(\"text\")\n    .text(getNodeLabel)\n    .attr(\"class\", \"nodeText\")\n    .classed(\"visible\", (d) => !d.children)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"y\", (d) => (d.children ? -5 : 0))\n    .attr(\"opacity\", 0);\n  return { svg, link, node, text };\n};\n\nexport const setupTooltip = (tooltipRef) => {\n  tooltipContainer = d3.select(tooltipRef.current);\n\n  tooltip = tooltipContainer\n    .append(\"div\")\n    .attr(\"class\", \"tooltip\")\n    .style(\"opacity\", 0);\n};\n\nconst onHover = (d, svg, link, node, text, tooltip, tooltipContainer) => {\n  const { slug, name, rank } = d.data;\n\n  if (d.children) {\n    // console.log(d3.select(`.node-${slug}`));\n    d3.select(`.node-${slug}`).raise();\n    svg.classed(\"inactive\", true);\n    // text.filter((d) => d.data.id === id).classed(\"visible\", true);\n\n    setSubtreeActive(d, true);\n\n    node.classed(\"active\", (d) => d.isActive);\n    text.classed(\"active\", (d) => d.isActive);\n    link.classed(\"active\", (d) => d.source.isActive);\n\n    const nodeInfo = familyInfo[slug];\n\n    if (nodeInfo) {\n      tooltip.html(\n        `<h4>${nodeInfo.name[lang]} /<span> ${rank[lang]}</span></h4><p>${nodeInfo.description[lang]}</p>`\n      );\n    } else {\n      tooltip.html(`<h4>${name} /<span> ${rank[lang]}</span></h4>`);\n    }\n    tooltipContainer.attr(\n      \"style\",\n      `transform: translate(${2 * d.x}px,${2 * d.y}px)`\n    );\n    tooltip.transition().duration(300).style(\"opacity\", 1);\n  } else {\n    // d3.select(`.image-${slug}`).attr(\"transform\", `scale(1.1)`);\n  }\n};\n\nlet hoverTimer;\n\nexport const setupInteractions = (parentComponent) => {\n  node\n    .on(\"mouseover\", (e, d) => {\n      hoverTimer = setTimeout(() => {\n        onHover(d, svg, link, node, text, tooltip, tooltipContainer);\n      }, 300);\n    })\n    .on(\"mouseout\", (e, d) => {\n      clearTimeout(hoverTimer);\n      if (d.children) {\n        svg.classed(\"inactive\", false);\n        setSubtreeActive(d, false);\n\n        const { id } = d.data;\n        text.filter((d) => d.data.id === id).classed(\"visible\", false);\n\n        tooltip.transition().duration(200).style(\"opacity\", 0);\n      }\n    })\n    .on(\"click\", (e, d) => {\n      parentComponent.handleClick(e, d);\n    });\n};\n\nexport const growTree = (growthTime = 400, callback = () => {}) => {\n  link\n    .attr(\"opacity\", 1)\n    .attr(\"stroke-dasharray\", (d) => linkLength(d) + \" \" + linkLength(d))\n    .attr(\"stroke-dashoffset\", (d) => linkLength(d))\n    .transition()\n    .delay((d) => d.source.depth * growthTime - 100)\n    .duration((d) => growthTime)\n    .ease(d3.easeLinear)\n    .attr(\"stroke-dashoffset\", 0)\n    .end()\n    .then(function (e) {\n      link.attr(\"stroke-dasharray\", \"none\");\n    });\n\n  svg\n    .selectAll(\"circle\")\n    .transition()\n    .delay((d) => d.depth * growthTime - 100)\n    .duration(growthTime)\n    .attr(\"transform\", \"\")\n    .end()\n    .then(callback);\n\n  svg\n    .selectAll(\"text\")\n    .transition()\n    .delay((d) => d.depth * growthTime + 500)\n    .duration(growthTime)\n    .attr(\"opacity\", 1)\n    .end()\n    .then(callback);\n\n  if (growthTime > 0) {\n    svg\n      .selectAll(\"image\")\n      .transition()\n      .delay((d) => d.depth * growthTime + 600 * Math.random() - 300)\n      .duration(growthTime)\n      .attr(\"transform\", \"scale(1)\");\n  }\n};\n\nconst setSubtreeActive = (root, isActive) => {\n  root.isActive = isActive;\n  root.children && root.children.forEach((d) => setSubtreeActive(d, isActive));\n};\n\nconst linkLength = (link) => {\n  return dist2D(link.source, link.target) + 3;\n};\n\nexport const updateGraphSize = (w, h) => {\n  width = w / 2;\n  height = h;\n  d3.select(svgEl).attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n  if (simulation) {\n    simulation.alpha(0.2).restart();\n\n    rootNode.fx = offsetX;\n    rootNode.fy = 0.5 * height - 1 * marginY;\n  }\n};\n\nconst highlightDuration = 600;\n\nexport const highlightHerb = (slug) => {\n  svg\n    .selectAll(\"image\")\n    .raise()\n    .transition()\n    .duration(highlightDuration / 2)\n    .attr(\"transform\", (d) =>\n      d.data.slug === slug ? \"scale(2)\" : \"scale(0.01)\"\n    );\n\n  for (let el of document.getElementsByClassName(\"highlighted\")) {\n    d3.select(el).classed(\"highlighted\", false);\n  }\n  const herbNode = document.getElementsByClassName(`node-${slug}`)[0];\n  d3.select(herbNode).classed(\"highlighted\", true);\n\n  positionHighlightedHerb();\n};\n\nexport const positionHighlightedHerb = () => {\n  const herbNode = document.getElementsByClassName(`highlighted`)[0];\n  if (herbNode) {\n    const { scrollTop } = containerEl.parentElement;\n\n    const herbRotation = degToRad(herbNode.transform.baseVal[1].angle);\n    let x = -2 * herbNode.transform.baseVal[0].matrix.e;\n    let y = -2 * herbNode.transform.baseVal[0].matrix.f;\n\n    const moveX = width < 700 ? width - (70 + 80) : 550;\n\n    x += moveX - 10 * Math.sin(herbRotation);\n    y += -550 + scrollTop - 25 * clamp01(-Math.cos(herbRotation));\n\n    svg\n      .transition()\n      .duration(highlightDuration)\n      .attr(\"transform\", `rotate(${0}) translate(${x} ${y})`);\n  }\n};\n\nexport const unhighlightAll = (scaleImages) => {\n  if (scaleImages) {\n    svg\n      .selectAll(\"image\")\n      .lower()\n      .transition()\n      .duration(highlightDuration)\n      .attr(\"transform\", \"scale(1)\");\n  }\n\n  for (let el of document.getElementsByClassName(\"highlighted\")) {\n    d3.select(el).classed(\"highlighted\", false);\n  }\n\n  d3.select(containerEl).attr(\"style\", \"\");\n\n  svg.transition().duration(highlightDuration).attr(\"transform\", \"\");\n};\n\nfunction handleMouseMove(event) {\n  const { x, offsetY } = event;\n  mousePos = {\n    x: (x - width) / 2,\n    y: (offsetY - height) / 2,\n  };\n  simulation.alpha(0.2).restart();\n}\n","import React from \"react\";\nimport { motion } from \"framer-motion\";\n\nconst FadeInOut = ({ children, enterDelay, ...rest }) => {\n  return (\n    <motion.div\n      {...rest}\n      initial={{ opacity: 0 }}\n      animate={{\n        transition: { delay: enterDelay ? enterDelay : 0 },\n        opacity: 1,\n      }}\n      exit={{ opacity: 0 }}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\nexport default FadeInOut;\n","import React from \"react\";\n\nimport \"./Button.scss\";\n\nconst Nav = ({ children, ...rest }) => {\n  return (\n    <button {...rest} className=\"Button\">\n      {children}\n    </button>\n  );\n};\n\nexport default Nav;\n","import React from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\n\nimport FadeInOut from \"../../components/FadeInOut/FadeInOut\";\nimport Button from \"../../components/Button/Button\";\n\nimport \"./HomePage.scss\";\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { logoOpacity: 1 };\n  }\n\n  componentDidMount() {\n    if (window.history.scrollRestoration) {\n      window.history.scrollRestoration = \"manual\";\n    }\n  }\n\n  handleScroll = () => {\n    const currScroll =\n      document.body.scrollTop || document.documentElement.scrollTop;\n\n    const opacityThreshold = 100;\n\n    if (currScroll > opacityThreshold) {\n      if (this.state.logoOpacity !== 0) this.setState({ logoOpacity: 0 });\n    } else {\n      this.setState({ logoOpacity: 1 - currScroll / opacityThreshold });\n    }\n  };\n\n  handleNodeClick = (node) => {\n    this.props.history.push(`/herb/${node.slug}`);\n  };\n\n  render() {\n    return (\n      <FadeInOut className=\"HomePage\">\n        {/*<HerbTree onNodeClick={this.handleNodeClick} />*/}\n        <Link to=\"/intro\" className=\"Help\">\n          <Button> ?</Button>\n        </Link>\n      </FadeInOut>\n    );\n  }\n}\n\nexport default withRouter(HomePage);\n","import React from \"react\";\nimport taxonomyTree from \"../../data/taxonomyTree.json\";\nimport {\n  initTree,\n  updateGraphSize,\n  showProtoPlant,\n  moveProtoPlant,\n  growTree,\n  fadeOut,\n} from \"./introGraphUtils\";\n\nimport \"./IntroGraph.scss\";\n\nclass IntroGraph extends React.Component {\n  constructor(props) {\n    super(props);\n    this.d3ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.setGraphSize();\n\n    const taxonomyTreePruned = removeSingleChildren(\n      JSON.parse(JSON.stringify(taxonomyTree))\n    );\n\n    this.simulation = initTree(this.d3ref, taxonomyTreePruned, this);\n\n    window.addEventListener(\"resize\", (e) => this.handleResize(e));\n  }\n\n  handleResize(e) {\n    this.setGraphSize();\n  }\n\n  setGraphSize() {\n    const w = document.documentElement.clientWidth;\n    const h = document.documentElement.clientHeight;\n    updateGraphSize(w, h);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.page !== prevProps.page) {\n      this.updateGraph(this.props.page);\n    }\n  }\n\n  updateGraph(page) {\n    switch (page) {\n      case 1:\n        showProtoPlant();\n        break;\n      case 2:\n        moveProtoPlant().then(growTree);\n        break;\n      case 3:\n        fadeOut();\n        break;\n      default:\n    }\n  }\n\n  logPositions() {\n    const nodePositions = {};\n    this.simulation.nodes().forEach((node, i) => {\n      nodePositions[node.data.id] = { x: node.x, y: node.y };\n    });\n    console.log(JSON.stringify(nodePositions));\n  }\n\n  render() {\n    return <div className=\"IntroGraph\" ref={this.d3ref}></div>;\n  }\n}\n\nconst removeSingleChildren = (node) => {\n  if (node.children) node.children.forEach(removeSingleChildren);\n  if (\n    node.children &&\n    node.children.length === 1 &&\n    node.rank.en !== \"Cladus\"\n  ) {\n    const { id, children, name, rank, slug } = node.children[0];\n    node.id = id;\n    node.children = children;\n    node.name = name;\n    node.rank = rank;\n    node.slug = slug;\n  }\n  return node;\n};\n\nexport default IntroGraph;\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { AnimatePresence } from \"framer-motion\";\n\nimport Button from \"../../components/Button/Button\";\nimport FadeInOut from \"../../components/FadeInOut/FadeInOut\";\nimport IntroGraph from \"../../components/IntroGraph/IntroGraph\";\n\nimport \"./IntroPage.scss\";\n\nconst IntroPage = (props) => {\n  const [page, setPage] = useState(0);\n\n  return (\n    <FadeInOut className=\"IntroPage\">\n      <IntroGraph page={page} />\n      <AnimatePresence exitBeforeEnter>\n        {renderPage(page, setPage)}\n      </AnimatePresence>\n      <Link to=\"/\" className=\"Skip\">\n        <Button> ></Button>\n      </Link>\n    </FadeInOut>\n  );\n};\n\nconst renderPage = (page, setPage) => {\n  switch (page) {\n    case 0:\n      return (\n        <FadeInOut className=\"page P0\" key=\"P0\">\n          <h1>  </h1>\n          <h2>   </h2>\n          <Button onClick={() => setPage(1)}> ?</Button>\n        </FadeInOut>\n      );\n    case 1:\n      return (\n        <FadeInOut className=\"page P1\" key=\"P1\" enterDelay={0.8}>\n          <p>      .</p>\n          <Button onClick={() => setPage(2)}></Button>\n        </FadeInOut>\n      );\n    case 2:\n      return (\n        <FadeInOut className=\"page P2\" key=\"P2\" enterDelay={3}>\n          <p>   ,     .</p>\n          <Button onClick={() => setPage(3)}></Button>\n        </FadeInOut>\n      );\n    case 3:\n      return (\n        <FadeInOut className=\"page P3\" key=\"P3\" enterDelay={1}>\n          <p>\n                   ,   .\n            <br />\n               , ,   .\n          </p>\n          <Link to=\"/\">\n            <Button>!</Button>\n          </Link>\n        </FadeInOut>\n      );\n    default:\n      return \"\";\n  }\n};\n\nexport default IntroPage;\n","import React from \"react\";\nimport lang from \"../../lang\";\nimport \"./HerbSummary.scss\";\n\nconst HerbSummary = (props) => {\n  const { slug, herb, family } = props;\n  const altNames = herb.altNames[lang];\n\n  return (\n    <div className=\"HerbSummary\">\n      <img\n        className=\"HerbIcon\"\n        id=\"herb-icon\"\n        src={`/images/icons/${slug}.png`}\n        alt={slug}\n      />\n      <table className=\"InfoTable\">\n        <tbody>\n          <tr>\n            <td colSpan=\"2\" className=\"scientificName\">\n              {herb.name}\n            </td>\n          </tr>\n          <tr>\n            <th></th>\n            <td>{herb.commonName[\"en\"]}</td>\n          </tr>\n          {altNames ? (\n            <tr>\n              <th> </th>\n              <td>{altNames}</td>\n            </tr>\n          ) : null}\n          <tr>\n            <th></th>\n            <td>{family.name[lang]}</td>\n          </tr>\n          <tr>\n            <th> </th>\n            <td>\n              {herb.lifeform[lang]} {herb.lifecycle[lang]}\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default HerbSummary;\n","import React from \"react\";\nimport ReactMarkdown from \"react-markdown\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport lang from \"../../lang\";\n\nimport FadeInOut from \"../../components/FadeInOut/FadeInOut\";\nimport HerbSummary from \"../../components/HerbSummary/HerbSummary\";\nimport herbInfo from \"../../data/herbInfo.json\";\nimport familyInfo from \"../../data/familyInfo.json\";\n\nimport \"./HerbPage.scss\";\n\nclass HerbPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { md: \"loading...\", imageLoaded: false, timerComplete: false };\n  }\n\n  async componentDidMount() {\n    const { slug } = this.props.match.params;\n    // const slug = \"bay-leaf\";\n    const response = await fetch(`/herb-pages/${slug}.md`);\n    const text = await response.text();\n\n    this.setState({\n      md: text,\n    });\n\n    setTimeout(() => this.setState({ timerComplete: true }), 1000);\n  }\n\n  handleImageLoad(e) {\n    this.setState({ imageLoaded: true });\n  }\n\n  render() {\n    const { slug } = this.props.match.params;\n    const { imageLoaded, timerComplete } = this.state;\n    // const slug = \"bay-leaf\";\n    const herb = herbInfo.filter((herb) => herb.slug === slug)[0];\n    const familyName = herb.taxonomy.find((rank) =>\n      rank.hasOwnProperty(\"Familia\")\n    ).Familia;\n    const family = familyInfo[familyName.toLowerCase()];\n\n    return (\n      <FadeInOut className=\"HerbPage\">\n        <main>\n          <Link to=\"/\" className=\"backIcon\">\n            <img\n              src=\"/images/ui/arrow-right.svg\"\n              className=\"Button\"\n              alt=\"Back\"\n            />\n            <span> </span>\n          </Link>\n          <HerbSummary herb={herb} slug={slug} family={family} />\n          <div className=\"HerbContent\">\n            <div className=\"herbPhoto\">\n              <img\n                src={`/images/photos/${slug}.jpg`}\n                alt={herb.commonName[lang]}\n                className={imageLoaded && timerComplete ? \"loaded\" : \"\"}\n                onLoad={(e) => this.handleImageLoad(e)}\n              />\n            </div>\n            <div className=\"mainText\">\n              <h1>{herb.commonName[lang]}</h1>\n              <ReactMarkdown\n                components={{\n                  a: (props) => <Link to={props.href}>{props.children}</Link>,\n                }}\n              >\n                {this.state.md}\n              </ReactMarkdown>\n              <h2> {family.name[lang]}</h2>\n              <p>{family.description[lang]}</p>\n            </div>\n          </div>\n        </main>\n      </FadeInOut>\n    );\n  }\n}\n\nexport default withRouter(HerbPage);\n","import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { debounce } from \"lodash\";\nimport taxonomyTree from \"../../data/taxonomyTree.json\";\nimport taxonomyTreeOverrides from \"../../data/taxonomyTreeOverrides.json\";\nimport {\n  initTree,\n  updateGraphSize,\n  highlightHerb,\n  unhighlightAll,\n  positionHighlightedHerb,\n  growTree,\n} from \"./graphUtils\";\nimport { clamp } from \"../../utils/math\";\n\nimport \"./HerbTree.scss\";\n\nconst MIN_LOGO_OPACITY = 0.15;\n\nclass HerbTree extends React.Component {\n  constructor(props) {\n    super(props);\n    this.containerRef = React.createRef();\n    this.d3ref = React.createRef();\n    this.tooltipRef = React.createRef();\n\n    this.state = {\n      logoOpacity: MIN_LOGO_OPACITY,\n      isHidden: true,\n      isMinimal: false,\n      isInteractive: true,\n      initalLoaded: false,\n    };\n\n    this.positionHighlightedHerbDebounced = debounce(\n      positionHighlightedHerb,\n      100\n    );\n  }\n\n  componentDidMount() {\n    this.setGraphSize();\n\n    const taxonomyTreePruned = applyNodeOverrides(\n      removeSingleChildren(JSON.parse(JSON.stringify(taxonomyTree)))\n    );\n    this.simulation = initTree(\n      this.d3ref,\n      this.tooltipRef,\n      taxonomyTreePruned,\n      this\n    );\n\n    this.containerRef.current.scrollTo(0, this.d3ref.current.scrollHeight);\n\n    window.addEventListener(\"resize\", (e) => this.handleResize(e));\n    setTimeout(() => {\n      this.onRouteChanged();\n      this.containerRef.current.addEventListener(\"scroll\", (e) =>\n        this.handleScroll(e)\n      );\n    }, 200);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n  }\n\n  handleScroll() {\n    const currScroll = this.containerRef.current.scrollTop;\n\n    const opacityThreshold = 100;\n\n    if (currScroll > opacityThreshold) {\n      if (this.state.logoOpacity !== 0)\n        this.setState({ logoOpacity: MIN_LOGO_OPACITY });\n    } else {\n      this.setState({\n        logoOpacity: clamp(\n          1 - currScroll / opacityThreshold,\n          MIN_LOGO_OPACITY,\n          0.9\n        ),\n      });\n    }\n  }\n\n  handleResize(e) {\n    this.positionHighlightedHerbDebounced();\n    this.setGraphSize();\n  }\n\n  handleClick(event, node) {\n    if (node.height === 0) {\n      this.props.onNodeClick(node.data);\n    }\n  }\n\n  setGraphSize() {\n    const w = document.documentElement.clientWidth;\n    // const h = document.documentElement.clientHeight;\n    updateGraphSize(w, 710);\n  }\n\n  logPositions() {\n    const nodePositions = {};\n    this.simulation.nodes().forEach((node, i) => {\n      nodePositions[node.data.id] = { x: node.x, y: node.y };\n    });\n    console.log(JSON.stringify(nodePositions));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.location !== prevProps.location) {\n      this.onRouteChanged(prevProps.location);\n    }\n  }\n\n  onRouteChanged(prevLocation) {\n    const route = this.props.location.pathname;\n    const routeParts = route.split(\"/\");\n    if (route === \"/\") {\n      this.setState({ isMinimal: false, isHidden: false });\n      this.setState({ isInteractive: true });\n      unhighlightAll(this.state.initalLoaded);\n\n      if (!this.state.initalLoaded) {\n        this.setState({ initalLoaded: true });\n        growTree(500);\n      }\n    } else {\n      this.setState({ isInteractive: false });\n      // this.containerRef.current.scrollTo({\n      //   top: 0,\n      //   left: 0,\n      //   behavior: \"smooth\",\n      // });\n      if (routeParts[1] === \"herb\") {\n        this.setState({\n          isMinimal: true,\n          isHidden: false,\n        });\n        growTree(0);\n        const herbSlug = routeParts[2];\n        highlightHerb(herbSlug);\n      } else if (routeParts[1] === \"intro\") {\n        this.setState({\n          isMinimal: false,\n          isHidden: true,\n        });\n      }\n    }\n  }\n\n  render() {\n    const { isMinimal, isHidden, isInteractive, logoOpacity } = this.state;\n    let classNames = \"HerbTree\";\n    if (isMinimal) classNames += \" minimal\";\n    if (isHidden) classNames += \" hidden\";\n    if (isInteractive) classNames += \" interactive\";\n    if ((isMinimal || isHidden) && this.simulation) this.simulation.stop();\n\n    const finalLogoOpacity = isMinimal || isHidden ? 0 : logoOpacity;\n\n    return (\n      <div className={classNames} ref={this.containerRef}>\n        <h1 className=\"Logo\" style={{ opacity: finalLogoOpacity }}>\n            \n        </h1>\n        {/*<button onClick={() => this.logPositions()}>Get positions</button>*/}\n        <div className=\"treeContainer\" ref={this.d3ref}>\n          <div className=\"tooltipContainer\" ref={this.tooltipRef}></div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst applyNodeOverrides = (node) => {\n  if (node.children) node.children.forEach(applyNodeOverrides);\n\n  // applyNodeOverrides\n  if (node.slug in taxonomyTreeOverrides) {\n    const overrideNode = taxonomyTreeOverrides[node.slug];\n    node.name = overrideNode.name;\n    node.rank = overrideNode.rank;\n    node.slug = overrideNode.slug;\n  }\n  return node;\n};\n\nconst removeSingleChildren = (node) => {\n  if (node.children) node.children.forEach(removeSingleChildren);\n  if (\n    node.children &&\n    node.children.length === 1 &&\n    node.rank.en !== \"Cladus\"\n  ) {\n    const { id, children, name, rank, slug } = node.children[0];\n    node.id = id;\n    node.children = children;\n    node.name = name;\n    node.rank = rank;\n    node.slug = slug;\n  }\n  return node;\n};\n\nexport default withRouter(HerbTree);\n","import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport Autosuggest from \"react-autosuggest\";\nimport lang from \"../../lang\";\n\nimport AutosuggestMatch from \"autosuggest-highlight/match\";\nimport AutosuggestParse from \"autosuggest-highlight/parse\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\n\nimport \"./Search.scss\";\n\nconst doesContainPrefix = (str, prefix) => {\n  return str\n    .split(\" \")\n    .reduce(\n      (containsPrefix, word) =>\n        containsPrefix || word.slice(0, prefix.length) === prefix,\n      false\n    );\n};\n\nconst getMatchedName = (herb, query) => {\n  let allNames = herb.altNames[lang].split(\",\");\n  allNames.unshift(herb.commonName[lang]);\n  let enNames = herb.altNames.en.toLowerCase().split(\",\");\n  enNames.unshift(herb.commonName.en.toLowerCase());\n  enNames.push(herb.name.toLowerCase());\n  allNames = allNames.concat(enNames);\n\n  const matchIndex = allNames.findIndex((name) =>\n    doesContainPrefix(name, query)\n  );\n  const matchName = matchIndex > -1 ? allNames[matchIndex] : \"\";\n  return { matchName, matchIndex };\n};\n\nconst getMatchIndex = (herb, query) => {\n  return getMatchedName(herb, query).matchIndex;\n};\n\n// How to calculate suggestions for any given input value.\nconst getSuggestions = (value) => {\n  const inputValue = value.trim().toLowerCase();\n  const inputLength = inputValue.length;\n\n  if (inputLength <= 1) return [];\n\n  // Sort results by index of match\n  const matchedHerbs = herbInfo\n    .map((herb, i) => ({\n      herb,\n      matchIndex: getMatchIndex(herb, inputValue),\n    }))\n    .filter((herb) => herb.matchIndex > -1)\n    .sort((h1, h2) => h1.matchIndex - h2.matchIndex);\n\n  return matchedHerbs.map((herb) => herb.herb);\n};\n\n// When suggestion is clicked, Autosuggest needs to populate the input\n// based on the clicked suggestion. Teach Autosuggest how to calculate the\n// input value for every given suggestion.\nconst getSuggestionValue = (suggestion) => suggestion.commonName[lang];\n\n// Use your imagination to render suggestions.\nconst renderSuggestion = (suggestion, { query }) => {\n  query = query.toLowerCase();\n  const commonName = suggestion.commonName[lang];\n  const suggestionText = getMatchedName(suggestion, query).matchName;\n\n  const matches = AutosuggestMatch(suggestionText, query);\n  const parts = AutosuggestParse(suggestionText, matches);\n\n  return (\n    <div>\n      <span className=\"name\">\n        {parts.map((part, index) => {\n          const className = part.highlight ? \"highlight\" : \"\";\n\n          return (\n            <span className={className} key={index}>\n              {part.text}\n            </span>\n          );\n        })}\n        {suggestionText !== commonName && ` (${commonName})`}\n      </span>\n    </div>\n  );\n};\n\nclass Search extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      value: \"\",\n      suggestions: [],\n      highlightedSuggestion: \"\",\n    };\n  }\n\n  isSuggestionHighlighted = () => {\n    const { suggestions, highlightedSuggestion } = this.state;\n    return suggestions.some((s) => s === highlightedSuggestion);\n  };\n\n  onChange = (event, { newValue }) => {\n    this.setState({\n      value: newValue,\n    });\n  };\n\n  // Autosuggest will call this function every time you need to update suggestions.\n  onSuggestionsFetchRequested = ({ value }) => {\n    this.setState({\n      suggestions: getSuggestions(value),\n    });\n  };\n\n  // Autosuggest will call this function every time you need to clear suggestions.\n  onSuggestionsClearRequested = () => {\n    this.setState({\n      suggestions: [],\n      highlightedSuggestion: \"\",\n    });\n  };\n\n  onSuggestionSelected = (e, { suggestion }) => {\n    this.goToResult(suggestion);\n  };\n\n  onSuggestionHighlighted = ({ suggestion }) => {\n    this.setState({ highlightedSuggestion: suggestion });\n  };\n\n  goToResult = (suggestion) => {\n    this.setState({\n      value: \"\",\n      suggestions: [],\n      highlightedSuggestion: \"\",\n    });\n    this.props.history.push(`/herb/${suggestion.slug}`);\n  };\n\n  onKeyDown = (e) => {\n    if (e.key === \"Enter\") {\n      const { suggestions } = this.state;\n      if (!this.isSuggestionHighlighted() && suggestions.length > 0) {\n        this.goToResult(suggestions[0]);\n      }\n    }\n  };\n\n  render() {\n    const { value, suggestions } = this.state;\n\n    // Autosuggest will pass through all these props to the input.\n    const inputProps = {\n      placeholder: \"\",\n      value,\n      onChange: this.onChange,\n      onKeyDown: this.onKeyDown,\n    };\n\n    return (\n      <div className=\"Search\">\n        <img src=\"/images/ui/search.svg\" alt=\"Search\" className=\"searchIcon\" />\n        <Autosuggest\n          suggestions={suggestions}\n          onSuggestionsFetchRequested={this.onSuggestionsFetchRequested}\n          onSuggestionsClearRequested={this.onSuggestionsClearRequested}\n          onSuggestionSelected={this.onSuggestionSelected}\n          onSuggestionHighlighted={this.onSuggestionHighlighted}\n          getSuggestionValue={getSuggestionValue}\n          renderSuggestion={renderSuggestion}\n          inputProps={inputProps}\n        />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Search);\n","import React from \"react\";\nimport { AnimatePresence } from \"framer-motion\";\nimport { Route, Switch, useLocation, useHistory } from \"react-router-dom\";\nimport HomePage from \"./pages/HomePage/HomePage\";\nimport IntroPage from \"./pages/IntroPage/IntroPage\";\nimport HerbPage from \"./pages/HerbPage/HerbPage\";\nimport HerbTree from \"./components/HerbTree/HerbTree\";\nimport Search from \"./components/Search/Search\";\n\nconst App = () => {\n  const history = useHistory();\n  const location = useLocation();\n\n  const handleNodeClick = (node) => {\n    history.push(`/herb/${node.slug}`);\n  };\n\n  return (\n    <div>\n      <Search />\n      <HerbTree onNodeClick={handleNodeClick} />\n      <AnimatePresence exitBeforeEnter>\n        <Switch location={location} key={location.pathname}>\n          <Route exact path=\"/\">\n            <HomePage />\n          </Route>\n          <Route exact path=\"/intro\">\n            <IntroPage />\n          </Route>\n          <Route path=\"/herb/:slug\">\n            <HerbPage />\n          </Route>\n        </Switch>\n      </AnimatePresence>\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport App from \"./App\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  // <React.StrictMode>\n  <Router>\n    <App />\n  </Router>,\n  // </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}