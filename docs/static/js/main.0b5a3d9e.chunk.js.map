{"version":3,"sources":["components/HerbTree/graphUtils.js","components/HerbTree/HerbTree.js","pages/HomePage/HomePage.js","pages/HerbPage/HerbPage.js","components/Search/Search.js","App.js","reportWebVitals.js","index.js","utils/math.js"],"names":["simulation","rootNode","graphEl","width","height","offsetX","imageSize","setupSimulation","nodes","links","d3","alphaDecay","force","id","d","distance","strength","radius","children","alpha","forEach","node","parent","y","wallRepulsionX","Math","max","abs","x","sign","getNodeLabel","data","name","herbInfo","commonName","drawGraph","ref","svg","current","append","attr","link","selectAll","join","slug","classed","filter","depth","call","drag","on","this","collisionRadius","text","setupTooltip","tooltipContainer","tooltip","style","setupInteractions","parentComponent","e","rank","raise","setSubtreeActive","isActive","source","nodeInfo","rankInfo","rankType","rankOverride","html","description","transition","duration","handleClick","enteranceTransition","growthTime","linkLength","delay","ease","end","then","random","event","active","alphaTarget","restart","fx","fy","root","dist2D","target","HerbTree","props","d3ref","React","createRef","setGraphSize","taxonomyTreePruned","removeSingleChildren","JSON","parse","stringify","taxonomyTree","descendants","i","initialNodePositions","fixed","setTimeout","transform","deltaX","deltaY","angle","radToDeg","atan2","xPos","yPos","label","dir","normalize2D","length","graph","window","scrollTo","document","body","scrollHeight","addEventListener","handleResize","onNodeClick","w","h","updateGraphSize","documentElement","clientWidth","min","clientHeight","nodePositions","console","log","className","Component","en","HomePage","handleScroll","currScroll","scrollTop","distToBottom","state","introOpacity","setState","handleNodeClick","redirect","debounce","history","scrollRestoration","removeEventListener","to","push","introDisplay","motion","div","initial","opacity","animate","exit","display","HerbPage","md","a","fetch","response","match","params","herb","src","alt","colSpan","altNames","lifeform","lifecycle","withRouter","getSuggestions","value","inputValue","trim","toLowerCase","inputLength","slice","getSuggestionValue","suggestion","renderSuggestion","Search","onChange","newValue","onSuggestionsFetchRequested","suggestions","onSuggestionsClearRequested","inputProps","placeholder","App","location","useLocation","AnimatePresence","exitBeforeEnter","exact","path","pathname","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","getElementById","defined","require","EPSILON","Number","clamp","lerp","t","inverseLerp","toFinite","n","defaultValue","isFinite","expandVector","dims","TypeError","p","scalar","out","lerpArray","newArray","initialValue","mod","b","damp","lambda","dt","exp","len2D","sqrt","module","exports","fract","floor","degToRad","PI","pingPong","linspace","opts","endpoint","offset","map","_","lerpFrames","values","len","whole","frame","nextFrame","Array","isArray","clamp01","v","smoothstep","dampArray","mapRange","inputMin","inputMax","outputMin","outputMax","outVal","expand2D","expand3D","expand4D","v1","v2"],"mappings":"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","file":"static/js/main.0b5a3d9e.chunk.js","sourcesContent":["import * as d3 from \"d3\";\nimport { radToDeg, normalize2D, dist2D } from \"../../utils/math\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\nimport rankInfo from \"../../data/rankInfo.json\";\nimport initialNodePositions from \"../../data/initialNodePositions.json\";\n\nimport lang from \"../../lang\";\n\nlet width = 400;\nlet height = 400;\nconst radius = 2;\nconst marginX = 15;\nconst marginY = 30;\nconst offsetX = -50;\nconst imageSize = 40;\nconst collisionRadius = 16;\n\nlet simulation;\nlet rootNode;\nlet graphEl;\n\nexport const graph = (ref, data, parentComponent) => {\n  rootNode = d3.hierarchy(data);\n  const links = rootNode.links();\n  const nodes = rootNode.descendants();\n  nodes.forEach((node, i) => {\n    const { id } = node.data;\n    if (id !== 1000 && initialNodePositions[id]) {\n      const { x, y } = initialNodePositions[id];\n      node.x = x;\n      node.y = y;\n    }\n  });\n\n  rootNode.fixed = true;\n  rootNode.fx = offsetX;\n  rootNode.fy = 0.5 * height - 1 * marginY;\n\n  simulation = setupSimulation(nodes, links);\n\n  const { svg, link, node, text } = drawGraph(ref, simulation, nodes, links);\n  graphEl = svg.node();\n\n  const { tooltipContainer, tooltip } = setupTooltip(svg);\n\n  // Enterance transition\n  setTimeout(() => {\n    enteranceTransition(link, svg);\n    setupInteractions(\n      svg,\n      link,\n      node,\n      text,\n      tooltip,\n      tooltipContainer,\n      parentComponent\n    );\n  }, 1000);\n\n  simulation.on(\"tick\", (e) => {\n    node.attr(\"transform\", (d) => {\n      let transform = `translate(${d.x},${d.y})`;\n      if (!d.children) {\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const angle = radToDeg(Math.atan2(deltaY, deltaX)) + 90;\n        transform += ` rotate(${angle})`;\n      }\n      return transform;\n    });\n\n    text.attr(\"transform\", (d) => {\n      let xPos = d.x;\n      let yPos = d.y;\n      if (!d.children) {\n        // Leaf nodes\n        const label = getNodeLabel(d);\n        const deltaX = d.x - d.parent.x;\n        const deltaY = d.y - d.parent.y;\n        const dir = normalize2D(deltaX, deltaY);\n        xPos += dir.x * (imageSize * 0.5 + label.length * 1.5);\n        yPos += dir.y * imageSize * 0.5;\n      }\n\n      return `translate(${xPos},${yPos})`;\n    });\n\n    link\n      .attr(\"x1\", (d) => d.source.x)\n      .attr(\"y1\", (d) => d.source.y)\n      .attr(\"x2\", (d) => d.target.x)\n      .attr(\"y2\", (d) => d.target.y);\n  });\n\n  return simulation;\n};\n\nexport const setupSimulation = (nodes, links) => {\n  return d3\n    .forceSimulation(nodes)\n    .alphaDecay(0.05)\n    .force(\n      \"link\",\n      d3\n        .forceLink(links)\n        .id((d) => d.id)\n        .distance(40)\n        .strength(1)\n    )\n    .force(\"charge\", d3.forceManyBody().strength(-80))\n    .force(\n      \"collision\",\n      d3.forceCollide().radius((d) => (d.children ? 2 : collisionRadius))\n    )\n    .force(\"x\", d3.forceX(offsetX))\n    .force(\"y\", d3.forceY())\n    .force(\"growth\", (alpha) => {\n      nodes.forEach((node) => {\n        // Cause nodes to be above their parents\n        if (node.parent && node.y > node.parent.y - 100) {\n          node.y -= alpha * 6;\n        }\n      });\n    })\n    .force(\"bounding\", (alpha) => {\n      nodes.forEach((node) => {\n        const wallRepulsionX =\n          alpha *\n          Math.max(1, Math.abs(node.x + offsetX) - (width / 2 - marginX));\n        node.x -= Math.sign(node.x) * wallRepulsionX;\n        // const wallRepulsionY =\n        //   alpha * Math.max(1, Math.abs(node.y) - (height / 2 - marginY));\n        // node.y -= Math.sign(node.y) * wallRepulsionY;\n      });\n    });\n};\n\nconst getNodeLabel = (d) => {\n  if (d.children) return `${d.data.name}`;\n  else return herbInfo[d.data.id].commonName[lang];\n};\n\nexport const drawGraph = (ref, simulation, nodes, links) => {\n  const svg = d3\n    .select(ref.current)\n    .append(\"svg\")\n    .attr(\"class\", \"graphContainer\")\n    .attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n\n  const link = svg\n    .append(\"g\")\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"class\", \"link\")\n    .attr(\"opacity\", 0);\n\n  const node = svg\n    .append(\"g\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .attr(\"class\", (d) => `node node-${d.data.slug}`)\n    .classed(\"internode\", (d) => d.children)\n    .classed(\"leaf\", (d) => !d.children)\n    .attr(\"id\", (d) => d.data.id);\n\n  // Allow dragging for all but root node\n  node.filter((d) => d.depth > 0).call(drag(simulation));\n\n  // Internodes\n  node\n    .filter((d) => d.children)\n    .append(\"circle\")\n    .attr(\"r\", radius)\n    .attr(\"opacity\", 0);\n\n  // Leaf images\n  node\n    .filter((d) => !d.children)\n    .append(\"svg:image\")\n    .attr(\"xlink:href\", (d) => `./images/icons/${d.data.slug}.png`)\n    .attr(\"class\", (d) => `image-${d.data.slug}`)\n    .on(\"error\", function (d) {\n      d3.select(this).attr(\"xlink:href\", \"./images/herb.png\");\n    })\n    .attr(\"x\", -imageSize / 2)\n    .attr(\"y\", -imageSize / 2)\n    .attr(\"width\", imageSize)\n    .attr(\"height\", imageSize)\n    .attr(\"transform\", \"scale(0.01)\");\n\n  // Leaf circle overlays\n  node\n    .filter((d) => !d.children)\n    .append(\"circle\")\n    .attr(\"r\", collisionRadius + 4);\n\n  // Leaf text\n  const text = svg\n    .append(\"g\")\n    .selectAll(\"g\")\n    .data(nodes)\n    .join(\"g\")\n    .append(\"text\")\n    .text(getNodeLabel)\n    .attr(\"class\", \"nodeText\")\n    .classed(\"visible\", (d) => !d.children)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"y\", (d) => (d.children ? -5 : 0))\n    .attr(\"opacity\", 0);\n  return { svg, link, node, text };\n};\n\nexport const setupTooltip = (svg) => {\n  const tooltipContainer = svg\n    .append(\"foreignObject\")\n    .attr(\"class\", \"tooltipContainer\")\n    .attr(\"width\", 200)\n    .attr(\"height\", 400);\n\n  const tooltip = tooltipContainer\n    .append(\"xhtml:div\")\n    .append(\"div\")\n    .attr(\"class\", \"tooltip\")\n    .style(\"opacity\", 0);\n\n  return { tooltipContainer, tooltip };\n};\n\nexport const setupInteractions = (\n  svg,\n  link,\n  node,\n  text,\n  tooltip,\n  tooltipContainer,\n  parentComponent\n) => {\n  node\n    .on(\"mouseover\", (e, d) => {\n      const { slug, name, rank } = d.data;\n\n      if (d.children) {\n        // console.log(d3.select(`.node-${slug}`));\n        d3.select(`.node-${slug}`).raise();\n        svg.classed(\"inactive\", true);\n        // text.filter((d) => d.data.id === id).classed(\"visible\", true);\n\n        setSubtreeActive(d, true);\n\n        node.classed(\"active\", (d) => d.isActive);\n        text.classed(\"active\", (d) => d.isActive);\n        link.classed(\"active\", (d) => d.source.isActive);\n\n        const nodeInfo = rankInfo[slug];\n\n        if (nodeInfo) {\n          const rankType = nodeInfo.rankOverride\n            ? nodeInfo.rankOverride[lang]\n            : rank[lang];\n          tooltip.html(\n            `<h4>${nodeInfo.name[lang]} /<span> ${rankType}</span></h4><p>${nodeInfo.description[lang]}</p>`\n          );\n        } else {\n          tooltip.html(`<h4>${name} /<span> ${rank[lang]}</span></h4>`);\n        }\n        tooltipContainer.attr(\"transform\", `translate(${d.x - 200},${d.y})`);\n        tooltip.transition().duration(300).style(\"opacity\", 1);\n      } else {\n        // d3.select(`.image-${slug}`).attr(\"transform\", `scale(1.1)`);\n      }\n    })\n    .on(\"mouseout\", (e, d) => {\n      // const { slug } = d.data;\n\n      if (d.children) {\n        svg.classed(\"inactive\", false);\n        setSubtreeActive(d, false);\n\n        const { id } = d.data;\n        text.filter((d) => d.data.id === id).classed(\"visible\", false);\n\n        tooltip.transition().duration(200).style(\"opacity\", 0);\n      } else {\n        // d3.select(`.image-${slug}`).attr(\"transform\", `scale(1)`);\n      }\n    })\n    .on(\"click\", (e, d) => {\n      parentComponent.handleClick(e, d);\n    });\n};\n\nexport const enteranceTransition = (link, svg) => {\n  const growthTime = 400;\n  link\n    .attr(\"opacity\", 1)\n    .attr(\"stroke-dasharray\", (d) => linkLength(d) + \" \" + linkLength(d))\n    .attr(\"stroke-dashoffset\", (d) => linkLength(d))\n    .transition()\n    .delay((d) => d.source.depth * growthTime - 100)\n    .duration((d) => growthTime)\n    .ease(d3.easeLinear)\n    .attr(\"stroke-dashoffset\", 0)\n    .end()\n    .then(function (e) {\n      link.attr(\"stroke-dasharray\", \"none\");\n    });\n\n  svg\n    .selectAll(\"circle, text\")\n    .transition()\n    .delay((d) => d.depth * growthTime + 500)\n    .duration(growthTime)\n    .attr(\"opacity\", 1);\n\n  svg\n    .selectAll(\"image\")\n    // .attr(\"opacity\", 1)\n    .transition()\n    .delay((d) => d.depth * growthTime + 600 * Math.random() - 300)\n    .duration(growthTime)\n    .attr(\"transform\", \"scale(1)\");\n};\n\nconst drag = (simulation) => {\n  function dragstarted(event, d) {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n\n  function dragged(event, d) {\n    d.fx = event.x;\n    d.fy = event.y;\n  }\n\n  function dragended(event, d) {\n    if (!event.active) simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n\n  return d3\n    .drag()\n    .on(\"start\", dragstarted)\n    .on(\"drag\", dragged)\n    .on(\"end\", dragended);\n};\n\nconst setSubtreeActive = (root, isActive) => {\n  root.isActive = isActive;\n  root.children && root.children.forEach((d) => setSubtreeActive(d, isActive));\n};\n\nconst linkLength = (link) => {\n  return dist2D(link.source, link.target) + 3;\n};\n\nexport const updateGraphSize = (w, h) => {\n  width = w / 2;\n  height = h;\n  d3.select(graphEl).attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n  if (simulation) {\n    simulation.alphaTarget(0.1).restart();\n\n    rootNode.fx = offsetX;\n    rootNode.fy = 0.5 * height - 1 * marginY;\n  }\n};\n","import React from \"react\";\nimport taxonomyTree from \"../../data/taxonomyTree.json\";\nimport { graph, updateGraphSize } from \"./graphUtils\";\nimport \"./HerbTree.scss\";\n\nclass HerbTree extends React.Component {\n  constructor(props) {\n    super(props);\n    this.d3ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.setGraphSize();\n\n    const taxonomyTreePruned = removeSingleChildren(\n      JSON.parse(JSON.stringify(taxonomyTree))\n    );\n    this.simulation = graph(this.d3ref, taxonomyTreePruned, this);\n\n    window.scrollTo(0, document.body.scrollHeight);\n    window.addEventListener(\"resize\", (e) => this.handleResize(e));\n  }\n\n  handleResize(e) {\n    this.setGraphSize();\n  }\n\n  handleClick(event, node) {\n    if (node.height === 0) this.props.onNodeClick(node.data);\n  }\n\n  setGraphSize() {\n    const w = document.documentElement.clientWidth;\n    const h = Math.min(document.documentElement.clientHeight, 750);\n    updateGraphSize(w, h);\n  }\n\n  logPositions() {\n    const nodePositions = {};\n    this.simulation.nodes().forEach((node, i) => {\n      nodePositions[node.data.id] = { x: node.x, y: node.y };\n    });\n    console.log(JSON.stringify(nodePositions));\n  }\n\n  render() {\n    return (\n      <div className=\"HerbTree\">\n        {/*<button onClick={() => this.logPositions()}>Get positions</button>*/}\n        <div ref={this.d3ref}></div>\n      </div>\n    );\n  }\n}\n\nconst removeSingleChildren = (node) => {\n  if (node.children) node.children.forEach(removeSingleChildren);\n  if (\n    node.children &&\n    node.children.length === 1 &&\n    node.rank.en !== \"Cladus\"\n  ) {\n    const { id, children, name, rank, slug } = node.children[0];\n    node.id = id;\n    node.children = children;\n    node.name = name;\n    node.rank = rank;\n    node.slug = slug;\n  }\n  return node;\n};\n\nexport default HerbTree;\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport { debounce } from \"lodash\";\nimport HerbTree from \"../../components/HerbTree/HerbTree\";\n// import WindowHeader from \"../../components/WindowHeader/WindowHeader\";\nimport \"./HomePage.scss\";\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { redirect: null, introOpacity: 1 };\n    this.handleScroll = debounce(this.handleScroll, 10);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"scroll\", this.handleScroll);\n    if (window.history.scrollRestoration) {\n      window.history.scrollRestoration = \"manual\";\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n  }\n\n  handleScroll = () => {\n    const currScroll =\n      document.body.scrollTop || document.documentElement.scrollTop;\n\n    const totalHeight =\n      document.documentElement.scrollHeight -\n      document.documentElement.clientHeight;\n\n    const distToBottom = totalHeight - currScroll;\n\n    const opacityThreshold = 100;\n\n    if (distToBottom > opacityThreshold) {\n      if (this.state.introOpacity !== 0) this.setState({ introOpacity: 0 });\n    } else {\n      this.setState({ introOpacity: 1 - distToBottom / opacityThreshold });\n    }\n  };\n\n  handleNodeClick = (node) => {\n    this.setState({ redirect: `/herb/${node.slug}` });\n  };\n\n  render() {\n    if (this.state.redirect) return <Redirect to={this.state.redirect} push />;\n    const { introOpacity } = this.state;\n    const introDisplay = introOpacity > 0 ? \"block\" : \"none\";\n\n    return (\n      <motion.div\n        className=\"HomePage\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      >\n        <HerbTree onNodeClick={this.handleNodeClick} />\n        <div\n          className=\"intro\"\n          style={{ opacity: introOpacity, display: introDisplay }}\n        >\n          <h1>על טעם וריח</h1>\n          <h2>מדריך לעשבי תיבול במטבח</h2>\n          <p>\n            צמחים שעליהם משמשים להוסיף טעם למאכלים ומשקאות. הרבה מעשבי התיבול\n            המוכרים ביותר כיום, כגון בזיליקום, פטרוזיליה ואורגנו, התפתחו\n            אבולוציונית באזור הים התיכון. באופן כללי, ניתן ללמוד הרבה על צמח\n            מהשיוך הגנטי שלו - איך כדאי לגדל אותו, איך לבשל איתו ואילו טעמים הוא\n            עשוי להכיל.\n          </p>\n          <p>\n            העץ שלפניכם מציג את השיוך הגנטי של צמחי תבלין נפוצים. שורש העץ מייצג\n            את האב הקדמון של כל הצמחים בכדור הארץ. כל ענף מכיל צמחים בעלי מקור\n            גנטי משותף, שבא לידי ביטוי גם במאפיינים שונים של הצמח. עברו עם העכבר\n            על נקודות שונות בעץ כדי לגלות עוד פרטים.\n          </p>\n        </div>\n      </motion.div>\n    );\n  }\n}\n\nexport default HomePage;\n","import React from \"react\";\nimport ReactMarkdown from \"react-markdown\";\nimport { motion } from \"framer-motion\";\nimport { withRouter } from \"react-router-dom\";\nimport lang from \"../../lang\";\n\nimport herbInfo from \"../../data/herbInfo.json\";\n\nimport \"./HerbPage.scss\";\n\nclass HerbPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { md: \"loading...\" };\n  }\n\n  async componentDidMount() {\n    // const { slug } = this.props.match.params;\n    const slug = \"bay-leaf\";\n    const response = await fetch(`/herb-pages/${slug}.md`);\n    const text = await response.text();\n\n    this.setState({\n      md: text,\n    });\n  }\n\n  render() {\n    const { slug } = this.props.match.params;\n    // const slug = \"bay-leaf\";\n    const herb = herbInfo.filter((herb) => herb.slug === slug)[0];\n\n    return (\n      <motion.div\n        className=\"HerbPage\"\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      >\n        <div className=\"HerbInfo\">\n          <img\n            className=\"HerbIcon\"\n            src={`/images/icons/${slug}.png`}\n            alt={slug}\n          />\n          <table className=\"InfoTable\">\n            <tbody>\n              <tr>\n                <td colSpan=\"2\" className=\"scientificName\">\n                  {herb.name}\n                </td>\n              </tr>\n              <tr>\n                <th>באנגלית</th>\n                <td>{herb.commonName[\"en\"]}</td>\n              </tr>\n              <tr>\n                <th>שמות נוספים</th>\n                <td>{herb.altNames[lang]}</td>\n              </tr>\n              <tr>\n                <th>משפחה</th>\n                <td>משפחה</td>\n              </tr>\n              <tr>\n                <th>צורת חיים</th>\n                <td>\n                  {herb.lifeform[lang]} {herb.lifecycle[lang]}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div className=\"HerbContent\">\n          <h1>{herb.commonName[lang]}</h1>\n          <ReactMarkdown>{this.state.md}</ReactMarkdown>\n        </div>\n      </motion.div>\n    );\n  }\n}\n\nexport default withRouter(HerbPage);\n","import React from \"react\";\nimport herbInfo from \"../../data/herbInfo.json\";\nimport Autosuggest from \"react-autosuggest\";\nimport lang from \"../../lang\";\n\nimport \"./Search.scss\";\n\n// Teach Autosuggest how to calculate suggestions for any given input value.\nconst getSuggestions = (value) => {\n  const inputValue = value.trim().toLowerCase();\n  const inputLength = inputValue.length;\n\n  return inputLength === 0\n    ? []\n    : herbInfo.filter(\n        (herb) =>\n          herb.commonName[lang].toLowerCase().slice(0, inputLength) ===\n          inputValue\n      );\n};\n\n// When suggestion is clicked, Autosuggest needs to populate the input\n// based on the clicked suggestion. Teach Autosuggest how to calculate the\n// input value for every given suggestion.\nconst getSuggestionValue = (suggestion) => suggestion.commonName[lang];\n\n// Use your imagination to render suggestions.\nconst renderSuggestion = (suggestion) => (\n  <div>{suggestion.commonName[lang]}</div>\n);\n\nclass Search extends React.Component {\n  constructor() {\n    super();\n\n    // Autosuggest is a controlled component.\n    // This means that you need to provide an input value\n    // and an onChange handler that updates this value (see below).\n    // Suggestions also need to be provided to the Autosuggest,\n    // and they are initially empty because the Autosuggest is closed.\n    this.state = {\n      value: \"\",\n      suggestions: [],\n    };\n  }\n\n  onChange = (event, { newValue }) => {\n    this.setState({\n      value: newValue,\n    });\n  };\n\n  // Autosuggest will call this function every time you need to update suggestions.\n  // You already implemented this logic above, so just use it.\n  onSuggestionsFetchRequested = ({ value }) => {\n    this.setState({\n      suggestions: getSuggestions(value),\n    });\n  };\n\n  // Autosuggest will call this function every time you need to clear suggestions.\n  onSuggestionsClearRequested = () => {\n    this.setState({\n      suggestions: [],\n    });\n  };\n\n  render() {\n    const { value, suggestions } = this.state;\n\n    // Autosuggest will pass through all these props to the input.\n    const inputProps = {\n      placeholder: \"חיפוש\",\n      value,\n      onChange: this.onChange,\n    };\n\n    // Finally, render it!\n    return (\n      <div className=\"Search\">\n        <img src=\"/images/ui/search.svg\" alt=\"Search\" className=\"searchIcon\" />\n        <Autosuggest\n          suggestions={suggestions}\n          onSuggestionsFetchRequested={this.onSuggestionsFetchRequested}\n          onSuggestionsClearRequested={this.onSuggestionsClearRequested}\n          getSuggestionValue={getSuggestionValue}\n          renderSuggestion={renderSuggestion}\n          inputProps={inputProps}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Search;\n","import React from \"react\";\nimport { AnimatePresence } from \"framer-motion\";\nimport { Route, Switch, useLocation } from \"react-router-dom\";\nimport HomePage from \"./pages/HomePage/HomePage\";\nimport HerbPage from \"./pages/HerbPage/HerbPage\";\nimport Search from \"./components/Search/Search\";\n\nconst App = () => {\n  const location = useLocation();\n  return (\n    <AnimatePresence exitBeforeEnter initial={false}>\n      <Search />\n      <Switch location={location} key={location.pathname}>\n        <Route exact path=\"/\">\n          <HomePage />\n        </Route>\n        <Route path=\"/herb/:slug\">\n          <HerbPage />\n        </Route>\n      </Switch>\n    </AnimatePresence>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport App from \"./App\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  // <React.StrictMode>\n  <Router>\n    <App />\n  </Router>,\n  // </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","var defined = require(\"defined\");\nvar EPSILON = Number.EPSILON;\n\nfunction clamp(value, min, max) {\n  return min < max\n    ? value < min\n      ? min\n      : value > max\n      ? max\n      : value\n    : value < max\n    ? max\n    : value > min\n    ? min\n    : value;\n}\n\nfunction clamp01(v) {\n  return clamp(v, 0, 1);\n}\n\nfunction lerp(min, max, t) {\n  return min * (1 - t) + max * t;\n}\n\nfunction inverseLerp(min, max, t) {\n  if (Math.abs(min - max) < EPSILON) return 0;\n  else return (t - min) / (max - min);\n}\n\nfunction smoothstep(min, max, t) {\n  var x = clamp(inverseLerp(min, max, t), 0, 1);\n  return x * x * (3 - 2 * x);\n}\n\nfunction toFinite(n, defaultValue) {\n  defaultValue = defined(defaultValue, 0);\n  return typeof n === \"number\" && isFinite(n) ? n : defaultValue;\n}\n\nfunction expandVector(dims) {\n  if (typeof dims !== \"number\") throw new TypeError(\"Expected dims argument\");\n  return function (p, defaultValue) {\n    defaultValue = defined(defaultValue, 0);\n    var scalar;\n    if (p == null) {\n      // No vector, create a default one\n      scalar = defaultValue;\n    } else if (typeof p === \"number\" && isFinite(p)) {\n      // Expand single channel to multiple vector\n      scalar = p;\n    }\n\n    var out = [];\n    var i;\n    if (scalar == null) {\n      for (i = 0; i < dims; i++) {\n        out[i] = toFinite(p[i], defaultValue);\n      }\n    } else {\n      for (i = 0; i < dims; i++) {\n        out[i] = scalar;\n      }\n    }\n    return out;\n  };\n}\n\nfunction lerpArray(min, max, t, out) {\n  out = out || [];\n  if (min.length !== max.length) {\n    throw new TypeError(\n      \"min and max array are expected to have the same length\"\n    );\n  }\n  for (var i = 0; i < min.length; i++) {\n    out[i] = lerp(min[i], max[i], t);\n  }\n  return out;\n}\n\nfunction newArray(n, initialValue) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  var out = [];\n  for (var i = 0; i < n; i++) out.push(initialValue);\n  return out;\n}\n\nfunction linspace(n, opts) {\n  n = defined(n, 0);\n  if (typeof n !== \"number\")\n    throw new TypeError(\"Expected n argument to be a number\");\n  opts = opts || {};\n  if (typeof opts === \"boolean\") {\n    opts = { endpoint: true };\n  }\n  var offset = defined(opts.offset, 0);\n  if (opts.endpoint) {\n    return newArray(n).map(function (_, i) {\n      return n <= 1 ? 0 : (i + offset) / (n - 1);\n    });\n  } else {\n    return newArray(n).map(function (_, i) {\n      return (i + offset) / n;\n    });\n  }\n}\n\nfunction lerpFrames(values, t, out) {\n  t = clamp(t, 0, 1);\n\n  var len = values.length - 1;\n  var whole = t * len;\n  var frame = Math.floor(whole);\n  var fract = whole - frame;\n\n  var nextFrame = Math.min(frame + 1, len);\n  var a = values[frame % values.length];\n  var b = values[nextFrame % values.length];\n  if (typeof a === \"number\" && typeof b === \"number\") {\n    return lerp(a, b, fract);\n  } else if (Array.isArray(a) && Array.isArray(b)) {\n    return lerpArray(a, b, fract, out);\n  } else {\n    throw new TypeError(\n      \"Mismatch in value type of two array elements: \" +\n        frame +\n        \" and \" +\n        nextFrame\n    );\n  }\n}\n\nfunction mod(a, b) {\n  return ((a % b) + b) % b;\n}\n\nfunction degToRad(n) {\n  return (n * Math.PI) / 180;\n}\n\nfunction radToDeg(n) {\n  return (n * 180) / Math.PI;\n}\n\nfunction fract(n) {\n  return n - Math.floor(n);\n}\n\nfunction sign(n) {\n  if (n > 0) return 1;\n  else if (n < 0) return -1;\n  else return 0;\n}\n\nfunction pingPong(t, length) {\n  t = mod(t, length * 2);\n  return length - Math.abs(t - length);\n}\n\nfunction damp(a, b, lambda, dt) {\n  return lerp(a, b, 1 - Math.exp(-lambda * dt));\n}\n\nfunction dampArray(a, b, lambda, dt, out) {\n  out = out || [];\n  for (var i = 0; i < a.length; i++) {\n    out[i] = damp(a[i], b[i], lambda, dt);\n  }\n  return out;\n}\n\nfunction normalize2D(x, y) {\n  const len = len2D(x, y);\n  return { x: x / len, y: y / len };\n}\n\nfunction len2D(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction mapRange(value, inputMin, inputMax, outputMin, outputMax, clamp) {\n  // Reference:\n  // https://openframeworks.cc/documentation/math/ofMath/\n  if (Math.abs(inputMin - inputMax) < EPSILON) {\n    return outputMin;\n  } else {\n    var outVal =\n      ((value - inputMin) / (inputMax - inputMin)) * (outputMax - outputMin) +\n      outputMin;\n    if (clamp) {\n      if (outputMax < outputMin) {\n        if (outVal < outputMax) outVal = outputMax;\n        else if (outVal > outputMin) outVal = outputMin;\n      } else {\n        if (outVal > outputMax) outVal = outputMax;\n        else if (outVal < outputMin) outVal = outputMin;\n      }\n    }\n    return outVal;\n  }\n}\n\nfunction dist2D(v1, v2) {\n  return len2D(v1.x - v2.x, v1.y - v2.y);\n}\n\nmodule.exports = {\n  mod: mod,\n  fract: fract,\n  sign: sign,\n  degToRad: degToRad,\n  radToDeg: radToDeg,\n  pingPong: pingPong,\n  linspace: linspace,\n  lerp: lerp,\n  lerpArray: lerpArray,\n  inverseLerp: inverseLerp,\n  lerpFrames: lerpFrames,\n  clamp: clamp,\n  clamp01: clamp01,\n  smoothstep: smoothstep,\n  damp: damp,\n  dampArray: dampArray,\n  mapRange: mapRange,\n  expand2D: expandVector(2),\n  expand3D: expandVector(3),\n  expand4D: expandVector(4),\n  normalize2D: normalize2D,\n  len2D: len2D,\n  dist2D: dist2D,\n};\n"],"sourceRoot":""}